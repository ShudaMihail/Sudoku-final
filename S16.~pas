unit S16;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, ExtCtrls;

type
  TForm3 = class(TForm)
    GroupBox1: TGroupBox;
    Panel1: TPanel;
    GroupBox2: TGroupBox;
    Button1: TButton;
    Button2: TButton;
    Button3: TButton;
    Button4: TButton;
    Button5: TButton;
    GroupBox3: TGroupBox;
    ComboBox1: TComboBox;
    GroupBox4: TGroupBox;
    Label1: TLabel;
    ListBox1: TListBox;
    E1_1: TEdit;
    E1_2: TEdit;
    E1_3: TEdit;
    E1_4: TEdit;
    E2_4: TEdit;
    E2_3: TEdit;
    E2_2: TEdit;
    E2_1: TEdit;
    E3_1: TEdit;
    E3_2: TEdit;
    E3_3: TEdit;
    E3_4: TEdit;
    E4_4: TEdit;
    E4_3: TEdit;
    E4_2: TEdit;
    E4_1: TEdit;
    Panel2: TPanel;
    E1_5: TEdit;
    E1_6: TEdit;
    E1_7: TEdit;
    E1_8: TEdit;
    E2_8: TEdit;
    E2_7: TEdit;
    E2_6: TEdit;
    E2_5: TEdit;
    E3_5: TEdit;
    E3_6: TEdit;
    E3_7: TEdit;
    E3_8: TEdit;
    E4_8: TEdit;
    E4_7: TEdit;
    E4_6: TEdit;
    E4_5: TEdit;
    Panel3: TPanel;
    E1_9: TEdit;
    E1_10: TEdit;
    E1_11: TEdit;
    E1_12: TEdit;
    E2_12: TEdit;
    E2_11: TEdit;
    E2_10: TEdit;
    E2_9: TEdit;
    E3_9: TEdit;
    E3_10: TEdit;
    E3_11: TEdit;
    E3_12: TEdit;
    E4_12: TEdit;
    E4_11: TEdit;
    E4_10: TEdit;
    E4_9: TEdit;
    Panel4: TPanel;
    E1_13: TEdit;
    E1_14: TEdit;
    E1_15: TEdit;
    E1_16: TEdit;
    E2_16: TEdit;
    E2_15: TEdit;
    E2_14: TEdit;
    E2_13: TEdit;
    E3_13: TEdit;
    E3_14: TEdit;
    E3_15: TEdit;
    E3_16: TEdit;
    E4_16: TEdit;
    E4_15: TEdit;
    E4_14: TEdit;
    E4_13: TEdit;
    Panel5: TPanel;
    E5_1: TEdit;
    E5_2: TEdit;
    E5_3: TEdit;
    E5_4: TEdit;
    E6_4: TEdit;
    E6_3: TEdit;
    E6_2: TEdit;
    E6_1: TEdit;
    E7_1: TEdit;
    E7_2: TEdit;
    E7_3: TEdit;
    E7_4: TEdit;
    E8_4: TEdit;
    E8_3: TEdit;
    E8_2: TEdit;
    E8_1: TEdit;
    Panel6: TPanel;
    E5_5: TEdit;
    E5_6: TEdit;
    E5_7: TEdit;
    E5_8: TEdit;
    E6_8: TEdit;
    E6_7: TEdit;
    E6_6: TEdit;
    E6_5: TEdit;
    E7_5: TEdit;
    E7_6: TEdit;
    E7_7: TEdit;
    E7_8: TEdit;
    E8_8: TEdit;
    E8_7: TEdit;
    E8_6: TEdit;
    E8_5: TEdit;
    Panel7: TPanel;
    E5_9: TEdit;
    E5_10: TEdit;
    E5_11: TEdit;
    E5_12: TEdit;
    E6_12: TEdit;
    E6_11: TEdit;
    E6_10: TEdit;
    E6_9: TEdit;
    E7_9: TEdit;
    E7_10: TEdit;
    E7_11: TEdit;
    E7_12: TEdit;
    E8_12: TEdit;
    E8_11: TEdit;
    E8_10: TEdit;
    E8_9: TEdit;
    Panel8: TPanel;
    E5_13: TEdit;
    E5_14: TEdit;
    E5_15: TEdit;
    E5_16: TEdit;
    E6_16: TEdit;
    E6_15: TEdit;
    E6_14: TEdit;
    E6_13: TEdit;
    E7_13: TEdit;
    E7_14: TEdit;
    E7_15: TEdit;
    E7_16: TEdit;
    E8_16: TEdit;
    E8_15: TEdit;
    E8_14: TEdit;
    E8_13: TEdit;
    Panel9: TPanel;
    E9_1: TEdit;
    E9_2: TEdit;
    E9_3: TEdit;
    E9_4: TEdit;
    E10_4: TEdit;
    E10_3: TEdit;
    E10_2: TEdit;
    E10_1: TEdit;
    E11_1: TEdit;
    E11_2: TEdit;
    E11_3: TEdit;
    E11_4: TEdit;
    E12_4: TEdit;
    E12_3: TEdit;
    E12_2: TEdit;
    E12_1: TEdit;
    Panel10: TPanel;
    E9_5: TEdit;
    E9_6: TEdit;
    E9_7: TEdit;
    E9_8: TEdit;
    E10_8: TEdit;
    E10_7: TEdit;
    E10_6: TEdit;
    E10_5: TEdit;
    E11_5: TEdit;
    E11_6: TEdit;
    E11_7: TEdit;
    E11_8: TEdit;
    E12_8: TEdit;
    E12_7: TEdit;
    E12_6: TEdit;
    E12_5: TEdit;
    Panel11: TPanel;
    E9_9: TEdit;
    E9_10: TEdit;
    E9_11: TEdit;
    E9_12: TEdit;
    E10_12: TEdit;
    E10_11: TEdit;
    E10_10: TEdit;
    E10_9: TEdit;
    E11_9: TEdit;
    E11_10: TEdit;
    E11_11: TEdit;
    E11_12: TEdit;
    E12_12: TEdit;
    E12_11: TEdit;
    E12_10: TEdit;
    E12_9: TEdit;
    Panel12: TPanel;
    E9_13: TEdit;
    E9_14: TEdit;
    E9_15: TEdit;
    E9_16: TEdit;
    E10_16: TEdit;
    E10_15: TEdit;
    E10_14: TEdit;
    E10_13: TEdit;
    E11_13: TEdit;
    E11_14: TEdit;
    E11_15: TEdit;
    E11_16: TEdit;
    E12_16: TEdit;
    E12_15: TEdit;
    E12_14: TEdit;
    E12_13: TEdit;
    Panel13: TPanel;
    E13_1: TEdit;
    E13_2: TEdit;
    E13_3: TEdit;
    E13_4: TEdit;
    E14_4: TEdit;
    E14_3: TEdit;
    E14_2: TEdit;
    E14_1: TEdit;
    E15_1: TEdit;
    E15_2: TEdit;
    E15_3: TEdit;
    E15_4: TEdit;
    E16_4: TEdit;
    E16_3: TEdit;
    E16_2: TEdit;
    E16_1: TEdit;
    Panel14: TPanel;
    E13_5: TEdit;
    E13_6: TEdit;
    E13_7: TEdit;
    E13_8: TEdit;
    E14_8: TEdit;
    E14_7: TEdit;
    E14_6: TEdit;
    E14_5: TEdit;
    E15_5: TEdit;
    E15_6: TEdit;
    E15_7: TEdit;
    E15_8: TEdit;
    E16_8: TEdit;
    E16_7: TEdit;
    E16_6: TEdit;
    E16_5: TEdit;
    Panel15: TPanel;
    E13_9: TEdit;
    E13_10: TEdit;
    E13_11: TEdit;
    E13_12: TEdit;
    E14_12: TEdit;
    E14_11: TEdit;
    E14_10: TEdit;
    E14_9: TEdit;
    E15_9: TEdit;
    E15_10: TEdit;
    E15_11: TEdit;
    E15_12: TEdit;
    E16_12: TEdit;
    E16_11: TEdit;
    E16_10: TEdit;
    E16_9: TEdit;
    Panel16: TPanel;
    E13_13: TEdit;
    E13_14: TEdit;
    E13_15: TEdit;
    E13_16: TEdit;
    E14_16: TEdit;
    E14_15: TEdit;
    E14_14: TEdit;
    E14_13: TEdit;
    E15_13: TEdit;
    E15_14: TEdit;
    E15_15: TEdit;
    E15_16: TEdit;
    E16_16: TEdit;
    E16_15: TEdit;
    E16_14: TEdit;
    E16_13: TEdit;
    Timer1: TTimer;
    OpenDialog1: TOpenDialog;
    SaveDialog1: TSaveDialog;
    procedure Button1Click(Sender: TObject);
    procedure Button5Click(Sender: TObject);
    procedure Timer1Timer(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure ComboBox1Change(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure Button3Click(Sender: TObject);
    procedure FormCloseQuery(Sender: TObject; var CanClose: Boolean);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure Button4Click(Sender: TObject);
    procedure E1_1KeyUp(Sender: TObject; var Key: Word;
      Shift: TShiftState);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form3: TForm3;

implementation

{$R *.dfm}

var
  Data:array[1..16,1..16]of string[1]; //Начальное поле данных
  Map:array[1..16,1..16]of string[1]; //Карта поля
  TimeGame:integer; //Время игры - для результата.
  DataToSave:array[1..16,1..16]of String[1]; //Поле для записи
  S:string[1];
  R:Integer; //Сообщения
  Level:byte;

Procedure Example;  //Заполнение начального поля данных
Begin
  Data[1,1]:='0';  Data[1,2]:='1';  Data[1,3]:='2';  Data[1,4]:='3';
  Data[1,5]:='4';  Data[1,6]:='5';  Data[1,7]:='6';  Data[1,8]:='7';
  Data[1,9]:='8';  Data[1,10]:='9';  Data[1,11]:='A';  Data[1,12]:='B';
  Data[1,13]:='C';  Data[1,14]:='D';  Data[1,15]:='E';  Data[1,16]:='F';

  Data[2,1]:='4';  Data[2,2]:='5';  Data[2,3]:='6';  Data[2,4]:='7';
  Data[2,5]:='8';  Data[2,6]:='9';  Data[2,7]:='A';  Data[2,8]:='B';
  Data[2,9]:='C';  Data[2,10]:='D';  Data[2,11]:='E';  Data[2,12]:='F';
  Data[2,13]:='0';  Data[2,14]:='1';  Data[2,15]:='2';  Data[2,16]:='3';

  Data[3,1]:='8';  Data[3,2]:='9';  Data[3,3]:='A';  Data[3,4]:='B';
  Data[3,5]:='C';  Data[3,6]:='D';  Data[3,7]:='E';  Data[3,8]:='F';
  Data[3,9]:='0';  Data[3,10]:='1';  Data[3,11]:='2';  Data[3,12]:='3';
  Data[3,13]:='4';  Data[3,14]:='5';  Data[3,15]:='6';  Data[3,16]:='7';

  Data[4,1]:='C';  Data[4,2]:='D';  Data[4,3]:='E';  Data[4,4]:='F';
  Data[4,5]:='0';  Data[4,6]:='1';  Data[4,7]:='2';  Data[4,8]:='3';
  Data[4,9]:='4';  Data[4,10]:='5';  Data[4,11]:='6';  Data[4,12]:='7';
  Data[4,13]:='8';  Data[4,14]:='9';  Data[4,15]:='A';  Data[4,16]:='B';

  Data[5,1]:='1';  Data[5,2]:='2';  Data[5,3]:='3';  Data[5,4]:='4';
  Data[5,5]:='5';  Data[5,6]:='6';  Data[5,7]:='7';  Data[5,8]:='8';
  Data[5,9]:='9';  Data[5,10]:='A';  Data[5,11]:='B';  Data[5,12]:='C';
  Data[5,13]:='D';  Data[5,14]:='E';  Data[5,15]:='F';  Data[5,16]:='0';

  Data[6,1]:='5';  Data[6,2]:='6';  Data[6,3]:='7';  Data[6,4]:='8';
  Data[6,5]:='9';  Data[6,6]:='A';  Data[6,7]:='B';  Data[6,8]:='C';
  Data[6,9]:='D';  Data[6,10]:='E';  Data[6,11]:='F';  Data[6,12]:='0';
  Data[6,13]:='1';  Data[6,14]:='2';  Data[6,15]:='3';  Data[6,16]:='4';

  Data[7,1]:='9';  Data[7,2]:='A';  Data[7,3]:='B';  Data[7,4]:='C';
  Data[7,5]:='D';  Data[7,6]:='E';  Data[7,7]:='F';  Data[7,8]:='0';
  Data[7,9]:='1';  Data[7,10]:='2';  Data[7,11]:='3';  Data[7,12]:='4';
  Data[7,13]:='5';  Data[7,14]:='6';  Data[7,15]:='7';  Data[7,16]:='8';

  Data[8,1]:='D';  Data[8,2]:='E';  Data[8,3]:='F';  Data[8,4]:='0';
  Data[8,5]:='1';  Data[8,6]:='2';  Data[8,7]:='3';  Data[8,8]:='4';
  Data[8,9]:='5';  Data[8,10]:='6';  Data[8,11]:='7';  Data[8,12]:='8';
  Data[8,13]:='9';  Data[8,14]:='A';  Data[8,15]:='B';  Data[8,16]:='C';

  Data[9,1]:='2';  Data[9,2]:='3';  Data[9,3]:='4';  Data[9,4]:='5';
  Data[9,5]:='6';  Data[9,6]:='7';  Data[9,7]:='8';  Data[9,8]:='9';
  Data[9,9]:='A';  Data[9,10]:='B';  Data[9,11]:='C';  Data[9,12]:='D';
  Data[9,13]:='E';  Data[9,14]:='F';  Data[9,15]:='0';  Data[9,16]:='1';

  Data[10,1]:='6';  Data[10,2]:='7';  Data[10,3]:='8';  Data[10,4]:='9';
  Data[10,5]:='A';  Data[10,6]:='B';  Data[10,7]:='C';  Data[10,8]:='D';
  Data[10,9]:='E';  Data[10,10]:='F';  Data[10,11]:='0';  Data[10,12]:='1';
  Data[10,13]:='2';  Data[10,14]:='3';  Data[10,15]:='4';  Data[10,16]:='5';

  Data[11,1]:='A';  Data[11,2]:='B';  Data[11,3]:='C';  Data[11,4]:='D';
  Data[11,5]:='E';  Data[11,6]:='F';  Data[11,7]:='0';  Data[11,8]:='1';
  Data[11,9]:='2';  Data[11,10]:='3';  Data[11,11]:='4';  Data[11,12]:='5';
  Data[11,13]:='6';  Data[11,14]:='7';  Data[11,15]:='8';  Data[11,16]:='9';

  Data[12,1]:='E';  Data[12,2]:='F';  Data[12,3]:='0';  Data[12,4]:='1';
  Data[12,5]:='2';  Data[12,6]:='3';  Data[12,7]:='4';  Data[12,8]:='5';
  Data[12,9]:='6';  Data[12,10]:='7';  Data[12,11]:='8';  Data[12,12]:='9';
  Data[12,13]:='A';  Data[12,14]:='B';  Data[12,15]:='C';  Data[12,16]:='D';

  Data[13,1]:='3';  Data[13,2]:='4';  Data[13,3]:='5';  Data[13,4]:='6';
  Data[13,5]:='7';  Data[13,6]:='8';  Data[13,7]:='9';  Data[13,8]:='A';
  Data[13,9]:='B';  Data[13,10]:='C';  Data[13,11]:='D';  Data[13,12]:='E';
  Data[13,13]:='F';  Data[13,14]:='0';  Data[13,15]:='1';  Data[13,16]:='2';

  Data[14,1]:='7';  Data[14,2]:='8';  Data[14,3]:='9';  Data[14,4]:='A';
  Data[14,5]:='B';  Data[14,6]:='C';  Data[14,7]:='D';  Data[14,8]:='E';
  Data[14,9]:='F';  Data[14,10]:='0';  Data[14,11]:='1';  Data[14,12]:='2';
  Data[14,13]:='3';  Data[14,14]:='4';  Data[14,15]:='5';  Data[14,16]:='6';

  Data[15,1]:='B';  Data[15,2]:='C';  Data[15,3]:='D';  Data[15,4]:='E';
  Data[15,5]:='F';  Data[15,6]:='0';  Data[15,7]:='1';  Data[15,8]:='2';
  Data[15,9]:='3';  Data[15,10]:='4';  Data[15,11]:='5';  Data[15,12]:='6';
  Data[15,13]:='7';  Data[15,14]:='8';  Data[15,15]:='9';  Data[15,16]:='A';

  Data[16,1]:='F';  Data[16,2]:='0';  Data[16,3]:='1';  Data[16,4]:='2';
  Data[16,5]:='3';  Data[16,6]:='4';  Data[16,7]:='5';  Data[16,8]:='6';
  Data[16,9]:='7';  Data[16,10]:='8';  Data[16,11]:='9';  Data[16,12]:='A';
  Data[16,13]:='B';  Data[16,14]:='C';  Data[16,15]:='D';  Data[16,16]:='E';
End;

Procedure Mapping;
Var
  i,j,x,y,k:byte;
  z,x1,x2:string[1];
Begin
  Randomize;

  //Транспонирование матрицы поля
  x:=random(8)+1;
  for i:=1 to 16 do
    for j:=1 to 16 do
    Case x of
      1 : Map[17-j,i]:=Data[i,j];
      2 : Map[17-i,17-j]:=Data[i,j];
      3 : Map[j,17-i]:=Data[i,j];
      4 : Map[i,j]:=Data[i,j];
      5 : Map[j,i]:=Data[i,j];
      6 : Map[17-i,j]:=Data[i,j];
      7 : Map[17-j,17-i]:=Data[i,j];
      8 : Map[i,17-j]:=Data[i,j];
    end;

  //Перетасовка строк
  for i:=1 to 4 do
    begin
    x:=random(4);
    y:=random(4);
    for j:=1 to 16 do
      begin
      z:=Map[i*4-x,j];
      Map[i*4-x,j]:=Map[i*4-y,j];
      Map[i*4-y,j]:=z;
      end;
    end;
  //Перетасовка строк
  for i:=1 to 4 do
    begin
    x:=random(4);
    y:=random(4);
    for j:=1 to 16 do
      begin
      z:=Map[i*4-x,j];
      Map[i*4-x,j]:=Map[i*4-y,j];
      Map[i*4-y,j]:=z;
      end;
    end;

  //Перетасовка столбцов
  for i:=1 to 4 do
    begin
    x:=random(4);
    y:=random(4);
    for j:=1 to 16 do
      begin
      z:=Map[j,i*4-x];
      Map[j,i*4-x]:=Map[j,i*4-y];
      Map[j,i*4-y]:=z;
      end;
    end;
    //Перетасовка столбцов
  for i:=1 to 4 do
    begin
    x:=random(4);
    y:=random(4);
    for j:=1 to 16 do
      begin
      z:=Map[j,i*4-x];
      Map[j,i*4-x]:=Map[j,i*4-y];
      Map[j,i*4-y]:=z;
      end;
    end;

  //Перетасовка областей-строк
  x:=random(4)+1;
  y:=random(4)+1;
  for i:=0 to 3 do
    for j:=1 to 16 do
    begin
    z:=Map[4*x-i,j];
    Map[4*x-i,j]:=Map[4*y-i,j];
    Map[4*y-i,j]:=z;
    end;
  //Перетасовка областей-строк
  x:=random(4)+1;
  y:=random(4)+1;
  for i:=0 to 3 do
    for j:=1 to 16 do
    begin
    z:=Map[4*x-i,j];
    Map[4*x-i,j]:=Map[4*y-i,j];
    Map[4*y-i,j]:=z;
    end;

  //Перетасовка областей-столбцов
  x:=random(4)+1;
  y:=random(4)+1;
  for i:=0 to 3 do
    for j:=1 to 16 do
    begin
    z:=Map[j,4*x-i];
    Map[j,4*x-i]:=Map[j,4*y-i];
    Map[j,4*y-i]:=z;
    end;
  //Перетасовка областей-столбцов
  x:=random(4)+1;
  y:=random(4)+1;
  for i:=0 to 3 do
    for j:=1 to 16 do
    begin
    z:=Map[j,4*x-i];
    Map[j,4*x-i]:=Map[j,4*y-i];
    Map[j,4*y-i]:=z;
    end;

  //Равносильная замена
  for k:=1 to 8 do
  begin
    x:=random(16);
    case x of
    10: x1:='A';
    11: x1:='B';
    12: x1:='C';
    13: x1:='D';
    14: x1:='E';
    15: x1:='F';
    else x1:=inttostr(x);
    end;
    y:=random(16);
    case y of
    10: x2:='A';
    11: x2:='B';
    12: x2:='C';
    13: x2:='D';
    14: x2:='E';
    15: x2:='F';
    else x2:=inttostr(y);
    end;

    for i:=1 to 16 do
      for j:=1 to 16 do
      begin
      if map[i,j]=x1 then map[i,j]:=x2
        else if map[i,j]=x2 then map[i,j]:=x1;
      end;
  end;
end;

Procedure MapToData;
Begin
DataToSave[1,1]:=S16.Form3.E1_1.Text;
DataToSave[1,2]:=S16.Form3.E1_2.Text;
DataToSave[1,3]:=S16.Form3.E1_3.Text;
DataToSave[1,4]:=S16.Form3.E1_4.Text;
DataToSave[1,5]:=S16.Form3.E1_5.Text;
DataToSave[1,6]:=S16.Form3.E1_6.Text;
DataToSave[1,7]:=S16.Form3.E1_7.Text;
DataToSave[1,8]:=S16.Form3.E1_8.Text;
DataToSave[1,9]:=S16.Form3.E1_9.Text;
DataToSave[1,10]:=S16.Form3.E1_10.Text;
DataToSave[1,11]:=S16.Form3.E1_11.Text;
DataToSave[1,12]:=S16.Form3.E1_12.Text;
DataToSave[1,13]:=S16.Form3.E1_13.Text;
DataToSave[1,14]:=S16.Form3.E1_14.Text;
DataToSave[1,15]:=S16.Form3.E1_15.Text;
DataToSave[1,16]:=S16.Form3.E1_16.Text;
DataToSave[2,1]:=S16.Form3.E2_1.Text;
DataToSave[2,2]:=S16.Form3.E2_2.Text;
DataToSave[2,3]:=S16.Form3.E2_3.Text;
DataToSave[2,4]:=S16.Form3.E2_4.Text;
DataToSave[2,5]:=S16.Form3.E2_5.Text;
DataToSave[2,6]:=S16.Form3.E2_6.Text;
DataToSave[2,7]:=S16.Form3.E2_7.Text;
DataToSave[2,8]:=S16.Form3.E2_8.Text;
DataToSave[2,9]:=S16.Form3.E2_9.Text;
DataToSave[2,10]:=S16.Form3.E2_10.Text;
DataToSave[2,11]:=S16.Form3.E2_11.Text;
DataToSave[2,12]:=S16.Form3.E2_12.Text;
DataToSave[2,13]:=S16.Form3.E2_13.Text;
DataToSave[2,14]:=S16.Form3.E2_14.Text;
DataToSave[2,15]:=S16.Form3.E2_15.Text;
DataToSave[2,16]:=S16.Form3.E2_16.Text;
DataToSave[3,1]:=S16.Form3.E3_1.Text;
DataToSave[3,2]:=S16.Form3.E3_2.Text;
DataToSave[3,3]:=S16.Form3.E3_3.Text;
DataToSave[3,4]:=S16.Form3.E3_4.Text;
DataToSave[3,5]:=S16.Form3.E3_5.Text;
DataToSave[3,6]:=S16.Form3.E3_6.Text;
DataToSave[3,7]:=S16.Form3.E3_7.Text;
DataToSave[3,8]:=S16.Form3.E3_8.Text;
DataToSave[3,9]:=S16.Form3.E3_9.Text;
DataToSave[3,10]:=S16.Form3.E3_10.Text;
DataToSave[3,11]:=S16.Form3.E3_11.Text;
DataToSave[3,12]:=S16.Form3.E3_12.Text;
DataToSave[3,13]:=S16.Form3.E3_13.Text;
DataToSave[3,14]:=S16.Form3.E3_14.Text;
DataToSave[3,15]:=S16.Form3.E3_15.Text;
DataToSave[3,16]:=S16.Form3.E3_16.Text;
DataToSave[4,1]:=S16.Form3.E4_1.Text;
DataToSave[4,2]:=S16.Form3.E4_2.Text;
DataToSave[4,3]:=S16.Form3.E4_3.Text;
DataToSave[4,4]:=S16.Form3.E4_4.Text;
DataToSave[4,5]:=S16.Form3.E4_5.Text;
DataToSave[4,6]:=S16.Form3.E4_6.Text;
DataToSave[4,7]:=S16.Form3.E4_7.Text;
DataToSave[4,8]:=S16.Form3.E4_8.Text;
DataToSave[4,9]:=S16.Form3.E4_9.Text;
DataToSave[4,10]:=S16.Form3.E4_10.Text;
DataToSave[4,11]:=S16.Form3.E4_11.Text;
DataToSave[4,12]:=S16.Form3.E4_12.Text;
DataToSave[4,13]:=S16.Form3.E4_13.Text;
DataToSave[4,14]:=S16.Form3.E4_14.Text;
DataToSave[4,15]:=S16.Form3.E4_15.Text;
DataToSave[4,16]:=S16.Form3.E4_16.Text;
DataToSave[5,1]:=S16.Form3.E5_1.Text;
DataToSave[5,2]:=S16.Form3.E5_2.Text;
DataToSave[5,3]:=S16.Form3.E5_3.Text;
DataToSave[5,4]:=S16.Form3.E5_4.Text;
DataToSave[5,5]:=S16.Form3.E5_5.Text;
DataToSave[5,6]:=S16.Form3.E5_6.Text;
DataToSave[5,7]:=S16.Form3.E5_7.Text;
DataToSave[5,8]:=S16.Form3.E5_8.Text;
DataToSave[5,9]:=S16.Form3.E5_9.Text;
DataToSave[5,10]:=S16.Form3.E5_10.Text;
DataToSave[5,11]:=S16.Form3.E5_11.Text;
DataToSave[5,12]:=S16.Form3.E5_12.Text;
DataToSave[5,13]:=S16.Form3.E5_13.Text;
DataToSave[5,14]:=S16.Form3.E5_14.Text;
DataToSave[5,15]:=S16.Form3.E5_15.Text;
DataToSave[5,16]:=S16.Form3.E5_16.Text;
DataToSave[6,1]:=S16.Form3.E6_1.Text;
DataToSave[6,2]:=S16.Form3.E6_2.Text;
DataToSave[6,3]:=S16.Form3.E6_3.Text;
DataToSave[6,4]:=S16.Form3.E6_4.Text;
DataToSave[6,5]:=S16.Form3.E6_5.Text;
DataToSave[6,6]:=S16.Form3.E6_6.Text;
DataToSave[6,7]:=S16.Form3.E6_7.Text;
DataToSave[6,8]:=S16.Form3.E6_8.Text;
DataToSave[6,9]:=S16.Form3.E6_9.Text;
DataToSave[6,10]:=S16.Form3.E6_10.Text;
DataToSave[6,11]:=S16.Form3.E6_11.Text;
DataToSave[6,12]:=S16.Form3.E6_12.Text;
DataToSave[6,13]:=S16.Form3.E6_13.Text;
DataToSave[6,14]:=S16.Form3.E6_14.Text;
DataToSave[6,15]:=S16.Form3.E6_15.Text;
DataToSave[6,16]:=S16.Form3.E6_16.Text;
DataToSave[7,1]:=S16.Form3.E7_1.Text;
DataToSave[7,2]:=S16.Form3.E7_2.Text;
DataToSave[7,3]:=S16.Form3.E7_3.Text;
DataToSave[7,4]:=S16.Form3.E7_4.Text;
DataToSave[7,5]:=S16.Form3.E7_5.Text;
DataToSave[7,6]:=S16.Form3.E7_6.Text;
DataToSave[7,7]:=S16.Form3.E7_7.Text;
DataToSave[7,8]:=S16.Form3.E7_8.Text;
DataToSave[7,9]:=S16.Form3.E7_9.Text;
DataToSave[7,10]:=S16.Form3.E7_10.Text;
DataToSave[7,11]:=S16.Form3.E7_11.Text;
DataToSave[7,12]:=S16.Form3.E7_12.Text;
DataToSave[7,13]:=S16.Form3.E7_13.Text;
DataToSave[7,14]:=S16.Form3.E7_14.Text;
DataToSave[7,15]:=S16.Form3.E7_15.Text;
DataToSave[7,16]:=S16.Form3.E7_16.Text;
DataToSave[8,1]:=S16.Form3.E8_1.Text;
DataToSave[8,2]:=S16.Form3.E8_2.Text;
DataToSave[8,3]:=S16.Form3.E8_3.Text;
DataToSave[8,4]:=S16.Form3.E8_4.Text;
DataToSave[8,5]:=S16.Form3.E8_5.Text;
DataToSave[8,6]:=S16.Form3.E8_6.Text;
DataToSave[8,7]:=S16.Form3.E8_7.Text;
DataToSave[8,8]:=S16.Form3.E8_8.Text;
DataToSave[8,9]:=S16.Form3.E8_9.Text;
DataToSave[8,10]:=S16.Form3.E8_10.Text;
DataToSave[8,11]:=S16.Form3.E8_11.Text;
DataToSave[8,12]:=S16.Form3.E8_12.Text;
DataToSave[8,13]:=S16.Form3.E8_13.Text;
DataToSave[8,14]:=S16.Form3.E8_14.Text;
DataToSave[8,15]:=S16.Form3.E8_15.Text;
DataToSave[8,16]:=S16.Form3.E8_16.Text;
DataToSave[9,1]:=S16.Form3.E9_1.Text;
DataToSave[9,2]:=S16.Form3.E9_2.Text;
DataToSave[9,3]:=S16.Form3.E9_3.Text;
DataToSave[9,4]:=S16.Form3.E9_4.Text;
DataToSave[9,5]:=S16.Form3.E9_5.Text;
DataToSave[9,6]:=S16.Form3.E9_6.Text;
DataToSave[9,7]:=S16.Form3.E9_7.Text;
DataToSave[9,8]:=S16.Form3.E9_8.Text;
DataToSave[9,9]:=S16.Form3.E9_9.Text;
DataToSave[9,10]:=S16.Form3.E9_10.Text;
DataToSave[9,11]:=S16.Form3.E9_11.Text;
DataToSave[9,12]:=S16.Form3.E9_12.Text;
DataToSave[9,13]:=S16.Form3.E9_13.Text;
DataToSave[9,14]:=S16.Form3.E9_14.Text;
DataToSave[9,15]:=S16.Form3.E9_15.Text;
DataToSave[9,16]:=S16.Form3.E9_16.Text;
DataToSave[10,1]:=S16.Form3.E10_1.Text;
DataToSave[10,2]:=S16.Form3.E10_2.Text;
DataToSave[10,3]:=S16.Form3.E10_3.Text;
DataToSave[10,4]:=S16.Form3.E10_4.Text;
DataToSave[10,5]:=S16.Form3.E10_5.Text;
DataToSave[10,6]:=S16.Form3.E10_6.Text;
DataToSave[10,7]:=S16.Form3.E10_7.Text;
DataToSave[10,8]:=S16.Form3.E10_8.Text;
DataToSave[10,9]:=S16.Form3.E10_9.Text;
DataToSave[10,10]:=S16.Form3.E10_10.Text;
DataToSave[10,11]:=S16.Form3.E10_11.Text;
DataToSave[10,12]:=S16.Form3.E10_12.Text;
DataToSave[10,13]:=S16.Form3.E10_13.Text;
DataToSave[10,14]:=S16.Form3.E10_14.Text;
DataToSave[10,15]:=S16.Form3.E10_15.Text;
DataToSave[10,16]:=S16.Form3.E10_16.Text;
DataToSave[11,1]:=S16.Form3.E11_1.Text;
DataToSave[11,2]:=S16.Form3.E11_2.Text;
DataToSave[11,3]:=S16.Form3.E11_3.Text;
DataToSave[11,4]:=S16.Form3.E11_4.Text;
DataToSave[11,5]:=S16.Form3.E11_5.Text;
DataToSave[11,6]:=S16.Form3.E11_6.Text;
DataToSave[11,7]:=S16.Form3.E11_7.Text;
DataToSave[11,8]:=S16.Form3.E11_8.Text;
DataToSave[11,9]:=S16.Form3.E11_9.Text;
DataToSave[11,10]:=S16.Form3.E11_10.Text;
DataToSave[11,11]:=S16.Form3.E11_11.Text;
DataToSave[11,12]:=S16.Form3.E11_12.Text;
DataToSave[11,13]:=S16.Form3.E11_13.Text;
DataToSave[11,14]:=S16.Form3.E11_14.Text;
DataToSave[11,15]:=S16.Form3.E11_15.Text;
DataToSave[11,16]:=S16.Form3.E11_16.Text;
DataToSave[12,1]:=S16.Form3.E12_1.Text;
DataToSave[12,2]:=S16.Form3.E12_2.Text;
DataToSave[12,3]:=S16.Form3.E12_3.Text;
DataToSave[12,4]:=S16.Form3.E12_4.Text;
DataToSave[12,5]:=S16.Form3.E12_5.Text;
DataToSave[12,6]:=S16.Form3.E12_6.Text;
DataToSave[12,7]:=S16.Form3.E12_7.Text;
DataToSave[12,8]:=S16.Form3.E12_8.Text;
DataToSave[12,9]:=S16.Form3.E12_9.Text;
DataToSave[12,10]:=S16.Form3.E12_10.Text;
DataToSave[12,11]:=S16.Form3.E12_11.Text;
DataToSave[12,12]:=S16.Form3.E12_12.Text;
DataToSave[12,13]:=S16.Form3.E12_13.Text;
DataToSave[12,14]:=S16.Form3.E12_14.Text;
DataToSave[12,15]:=S16.Form3.E12_15.Text;
DataToSave[12,16]:=S16.Form3.E12_16.Text;
DataToSave[13,1]:=S16.Form3.E13_1.Text;
DataToSave[13,2]:=S16.Form3.E13_2.Text;
DataToSave[13,3]:=S16.Form3.E13_3.Text;
DataToSave[13,4]:=S16.Form3.E13_4.Text;
DataToSave[13,5]:=S16.Form3.E13_5.Text;
DataToSave[13,6]:=S16.Form3.E13_6.Text;
DataToSave[13,7]:=S16.Form3.E13_7.Text;
DataToSave[13,8]:=S16.Form3.E13_8.Text;
DataToSave[13,9]:=S16.Form3.E13_9.Text;
DataToSave[13,10]:=S16.Form3.E13_10.Text;
DataToSave[13,11]:=S16.Form3.E13_11.Text;
DataToSave[13,12]:=S16.Form3.E13_12.Text;
DataToSave[13,13]:=S16.Form3.E13_13.Text;
DataToSave[13,14]:=S16.Form3.E13_14.Text;
DataToSave[13,15]:=S16.Form3.E13_15.Text;
DataToSave[13,16]:=S16.Form3.E13_16.Text;
DataToSave[14,1]:=S16.Form3.E14_1.Text;
DataToSave[14,2]:=S16.Form3.E14_2.Text;
DataToSave[14,3]:=S16.Form3.E14_3.Text;
DataToSave[14,4]:=S16.Form3.E14_4.Text;
DataToSave[14,5]:=S16.Form3.E14_5.Text;
DataToSave[14,6]:=S16.Form3.E14_6.Text;
DataToSave[14,7]:=S16.Form3.E14_7.Text;
DataToSave[14,8]:=S16.Form3.E14_8.Text;
DataToSave[14,9]:=S16.Form3.E14_9.Text;
DataToSave[14,10]:=S16.Form3.E14_10.Text;
DataToSave[14,11]:=S16.Form3.E14_11.Text;
DataToSave[14,12]:=S16.Form3.E14_12.Text;
DataToSave[14,13]:=S16.Form3.E14_13.Text;
DataToSave[14,14]:=S16.Form3.E14_14.Text;
DataToSave[14,15]:=S16.Form3.E14_15.Text;
DataToSave[14,16]:=S16.Form3.E14_16.Text;
DataToSave[15,1]:=S16.Form3.E15_1.Text;
DataToSave[15,2]:=S16.Form3.E15_2.Text;
DataToSave[15,3]:=S16.Form3.E15_3.Text;
DataToSave[15,4]:=S16.Form3.E15_4.Text;
DataToSave[15,5]:=S16.Form3.E15_5.Text;
DataToSave[15,6]:=S16.Form3.E15_6.Text;
DataToSave[15,7]:=S16.Form3.E15_7.Text;
DataToSave[15,8]:=S16.Form3.E15_8.Text;
DataToSave[15,9]:=S16.Form3.E15_9.Text;
DataToSave[15,10]:=S16.Form3.E15_10.Text;
DataToSave[15,11]:=S16.Form3.E15_11.Text;
DataToSave[15,12]:=S16.Form3.E15_12.Text;
DataToSave[15,13]:=S16.Form3.E15_13.Text;
DataToSave[15,14]:=S16.Form3.E15_14.Text;
DataToSave[15,15]:=S16.Form3.E15_15.Text;
DataToSave[15,16]:=S16.Form3.E15_16.Text;
DataToSave[16,1]:=S16.Form3.E16_1.Text;
DataToSave[16,2]:=S16.Form3.E16_2.Text;
DataToSave[16,3]:=S16.Form3.E16_3.Text;
DataToSave[16,4]:=S16.Form3.E16_4.Text;
DataToSave[16,5]:=S16.Form3.E16_5.Text;
DataToSave[16,6]:=S16.Form3.E16_6.Text;
DataToSave[16,7]:=S16.Form3.E16_7.Text;
DataToSave[16,8]:=S16.Form3.E16_8.Text;
DataToSave[16,9]:=S16.Form3.E16_9.Text;
DataToSave[16,10]:=S16.Form3.E16_10.Text;
DataToSave[16,11]:=S16.Form3.E16_11.Text;
DataToSave[16,12]:=S16.Form3.E16_12.Text;
DataToSave[16,13]:=S16.Form3.E16_13.Text;
DataToSave[16,14]:=S16.Form3.E16_14.Text;
DataToSave[16,15]:=S16.Form3.E16_15.Text;
DataToSave[16,16]:=S16.Form3.E16_16.Text;
End;

Procedure Clearing;
Begin
S16.Form3.E1_1.Enabled:=true;
S16.Form3.E1_2.Enabled:=true;
S16.Form3.E1_3.Enabled:=true;
S16.Form3.E1_4.Enabled:=true;
S16.Form3.E1_5.Enabled:=true;
S16.Form3.E1_6.Enabled:=true;
S16.Form3.E1_7.Enabled:=true;
S16.Form3.E1_8.Enabled:=true;
S16.Form3.E1_9.Enabled:=true;
S16.Form3.E1_10.Enabled:=true;
S16.Form3.E1_11.Enabled:=true;
S16.Form3.E1_12.Enabled:=true;
S16.Form3.E1_13.Enabled:=true;
S16.Form3.E1_14.Enabled:=true;
S16.Form3.E1_15.Enabled:=true;
S16.Form3.E1_16.Enabled:=true;
S16.Form3.E2_1.Enabled:=true;
S16.Form3.E2_2.Enabled:=true;
S16.Form3.E2_3.Enabled:=true;
S16.Form3.E2_4.Enabled:=true;
S16.Form3.E2_5.Enabled:=true;
S16.Form3.E2_6.Enabled:=true;
S16.Form3.E2_7.Enabled:=true;
S16.Form3.E2_8.Enabled:=true;
S16.Form3.E2_9.Enabled:=true;
S16.Form3.E2_10.Enabled:=true;
S16.Form3.E2_11.Enabled:=true;
S16.Form3.E2_12.Enabled:=true;
S16.Form3.E2_13.Enabled:=true;
S16.Form3.E2_14.Enabled:=true;
S16.Form3.E2_15.Enabled:=true;
S16.Form3.E2_16.Enabled:=true;
S16.Form3.E3_1.Enabled:=true;
S16.Form3.E3_2.Enabled:=true;
S16.Form3.E3_3.Enabled:=true;
S16.Form3.E3_4.Enabled:=true;
S16.Form3.E3_5.Enabled:=true;
S16.Form3.E3_6.Enabled:=true;
S16.Form3.E3_7.Enabled:=true;
S16.Form3.E3_8.Enabled:=true;
S16.Form3.E3_9.Enabled:=true;
S16.Form3.E3_10.Enabled:=true;
S16.Form3.E3_11.Enabled:=true;
S16.Form3.E3_12.Enabled:=true;
S16.Form3.E3_13.Enabled:=true;
S16.Form3.E3_14.Enabled:=true;
S16.Form3.E3_15.Enabled:=true;
S16.Form3.E3_16.Enabled:=true;
S16.Form3.E4_1.Enabled:=true;
S16.Form3.E4_2.Enabled:=true;
S16.Form3.E4_3.Enabled:=true;
S16.Form3.E4_4.Enabled:=true;
S16.Form3.E4_5.Enabled:=true;
S16.Form3.E4_6.Enabled:=true;
S16.Form3.E4_7.Enabled:=true;
S16.Form3.E4_8.Enabled:=true;
S16.Form3.E4_9.Enabled:=true;
S16.Form3.E4_10.Enabled:=true;
S16.Form3.E4_11.Enabled:=true;
S16.Form3.E4_12.Enabled:=true;
S16.Form3.E4_13.Enabled:=true;
S16.Form3.E4_14.Enabled:=true;
S16.Form3.E4_15.Enabled:=true;
S16.Form3.E4_16.Enabled:=true;
S16.Form3.E5_1.Enabled:=true;
S16.Form3.E5_2.Enabled:=true;
S16.Form3.E5_3.Enabled:=true;
S16.Form3.E5_4.Enabled:=true;
S16.Form3.E5_5.Enabled:=true;
S16.Form3.E5_6.Enabled:=true;
S16.Form3.E5_7.Enabled:=true;
S16.Form3.E5_8.Enabled:=true;
S16.Form3.E5_9.Enabled:=true;
S16.Form3.E5_10.Enabled:=true;
S16.Form3.E5_11.Enabled:=true;
S16.Form3.E5_12.Enabled:=true;
S16.Form3.E5_13.Enabled:=true;
S16.Form3.E5_14.Enabled:=true;
S16.Form3.E5_15.Enabled:=true;
S16.Form3.E5_16.Enabled:=true;
S16.Form3.E6_1.Enabled:=true;
S16.Form3.E6_2.Enabled:=true;
S16.Form3.E6_3.Enabled:=true;
S16.Form3.E6_4.Enabled:=true;
S16.Form3.E6_5.Enabled:=true;
S16.Form3.E6_6.Enabled:=true;
S16.Form3.E6_7.Enabled:=true;
S16.Form3.E6_8.Enabled:=true;
S16.Form3.E6_9.Enabled:=true;
S16.Form3.E6_10.Enabled:=true;
S16.Form3.E6_11.Enabled:=true;
S16.Form3.E6_12.Enabled:=true;
S16.Form3.E6_13.Enabled:=true;
S16.Form3.E6_14.Enabled:=true;
S16.Form3.E6_15.Enabled:=true;
S16.Form3.E6_16.Enabled:=true;
S16.Form3.E7_1.Enabled:=true;
S16.Form3.E7_2.Enabled:=true;
S16.Form3.E7_3.Enabled:=true;
S16.Form3.E7_4.Enabled:=true;
S16.Form3.E7_5.Enabled:=true;
S16.Form3.E7_6.Enabled:=true;
S16.Form3.E7_7.Enabled:=true;
S16.Form3.E7_8.Enabled:=true;
S16.Form3.E7_9.Enabled:=true;
S16.Form3.E7_10.Enabled:=true;
S16.Form3.E7_11.Enabled:=true;
S16.Form3.E7_12.Enabled:=true;
S16.Form3.E7_13.Enabled:=true;
S16.Form3.E7_14.Enabled:=true;
S16.Form3.E7_15.Enabled:=true;
S16.Form3.E7_16.Enabled:=true;
S16.Form3.E8_1.Enabled:=true;
S16.Form3.E8_2.Enabled:=true;
S16.Form3.E8_3.Enabled:=true;
S16.Form3.E8_4.Enabled:=true;
S16.Form3.E8_5.Enabled:=true;
S16.Form3.E8_6.Enabled:=true;
S16.Form3.E8_7.Enabled:=true;
S16.Form3.E8_8.Enabled:=true;
S16.Form3.E8_9.Enabled:=true;
S16.Form3.E8_10.Enabled:=true;
S16.Form3.E8_11.Enabled:=true;
S16.Form3.E8_12.Enabled:=true;
S16.Form3.E8_13.Enabled:=true;
S16.Form3.E8_14.Enabled:=true;
S16.Form3.E8_15.Enabled:=true;
S16.Form3.E8_16.Enabled:=true;
S16.Form3.E9_1.Enabled:=true;
S16.Form3.E9_2.Enabled:=true;
S16.Form3.E9_3.Enabled:=true;
S16.Form3.E9_4.Enabled:=true;
S16.Form3.E9_5.Enabled:=true;
S16.Form3.E9_6.Enabled:=true;
S16.Form3.E9_7.Enabled:=true;
S16.Form3.E9_8.Enabled:=true;
S16.Form3.E9_9.Enabled:=true;
S16.Form3.E9_10.Enabled:=true;
S16.Form3.E9_11.Enabled:=true;
S16.Form3.E9_12.Enabled:=true;
S16.Form3.E9_13.Enabled:=true;
S16.Form3.E9_14.Enabled:=true;
S16.Form3.E9_15.Enabled:=true;
S16.Form3.E9_16.Enabled:=true;
S16.Form3.E10_1.Enabled:=true;
S16.Form3.E10_2.Enabled:=true;
S16.Form3.E10_3.Enabled:=true;
S16.Form3.E10_4.Enabled:=true;
S16.Form3.E10_5.Enabled:=true;
S16.Form3.E10_6.Enabled:=true;
S16.Form3.E10_7.Enabled:=true;
S16.Form3.E10_8.Enabled:=true;
S16.Form3.E10_9.Enabled:=true;
S16.Form3.E10_10.Enabled:=true;
S16.Form3.E10_11.Enabled:=true;
S16.Form3.E10_12.Enabled:=true;
S16.Form3.E10_13.Enabled:=true;
S16.Form3.E10_14.Enabled:=true;
S16.Form3.E10_15.Enabled:=true;
S16.Form3.E10_16.Enabled:=true;
S16.Form3.E11_1.Enabled:=true;
S16.Form3.E11_2.Enabled:=true;
S16.Form3.E11_3.Enabled:=true;
S16.Form3.E11_4.Enabled:=true;
S16.Form3.E11_5.Enabled:=true;
S16.Form3.E11_6.Enabled:=true;
S16.Form3.E11_7.Enabled:=true;
S16.Form3.E11_8.Enabled:=true;
S16.Form3.E11_9.Enabled:=true;
S16.Form3.E11_10.Enabled:=true;
S16.Form3.E11_11.Enabled:=true;
S16.Form3.E11_12.Enabled:=true;
S16.Form3.E11_13.Enabled:=true;
S16.Form3.E11_14.Enabled:=true;
S16.Form3.E11_15.Enabled:=true;
S16.Form3.E11_16.Enabled:=true;
S16.Form3.E12_1.Enabled:=true;
S16.Form3.E12_2.Enabled:=true;
S16.Form3.E12_3.Enabled:=true;
S16.Form3.E12_4.Enabled:=true;
S16.Form3.E12_5.Enabled:=true;
S16.Form3.E12_6.Enabled:=true;
S16.Form3.E12_7.Enabled:=true;
S16.Form3.E12_8.Enabled:=true;
S16.Form3.E12_9.Enabled:=true;
S16.Form3.E12_10.Enabled:=true;
S16.Form3.E12_11.Enabled:=true;
S16.Form3.E12_12.Enabled:=true;
S16.Form3.E12_13.Enabled:=true;
S16.Form3.E12_14.Enabled:=true;
S16.Form3.E12_15.Enabled:=true;
S16.Form3.E12_16.Enabled:=true;
S16.Form3.E13_1.Enabled:=true;
S16.Form3.E13_2.Enabled:=true;
S16.Form3.E13_3.Enabled:=true;
S16.Form3.E13_4.Enabled:=true;
S16.Form3.E13_5.Enabled:=true;
S16.Form3.E13_6.Enabled:=true;
S16.Form3.E13_7.Enabled:=true;
S16.Form3.E13_8.Enabled:=true;
S16.Form3.E13_9.Enabled:=true;
S16.Form3.E13_10.Enabled:=true;
S16.Form3.E13_11.Enabled:=true;
S16.Form3.E13_12.Enabled:=true;
S16.Form3.E13_13.Enabled:=true;
S16.Form3.E13_14.Enabled:=true;
S16.Form3.E13_15.Enabled:=true;
S16.Form3.E13_16.Enabled:=true;
S16.Form3.E14_1.Enabled:=true;
S16.Form3.E14_2.Enabled:=true;
S16.Form3.E14_3.Enabled:=true;
S16.Form3.E14_4.Enabled:=true;
S16.Form3.E14_5.Enabled:=true;
S16.Form3.E14_6.Enabled:=true;
S16.Form3.E14_7.Enabled:=true;
S16.Form3.E14_8.Enabled:=true;
S16.Form3.E14_9.Enabled:=true;
S16.Form3.E14_10.Enabled:=true;
S16.Form3.E14_11.Enabled:=true;
S16.Form3.E14_12.Enabled:=true;
S16.Form3.E14_13.Enabled:=true;
S16.Form3.E14_14.Enabled:=true;
S16.Form3.E14_15.Enabled:=true;
S16.Form3.E14_16.Enabled:=true;
S16.Form3.E15_1.Enabled:=true;
S16.Form3.E15_2.Enabled:=true;
S16.Form3.E15_3.Enabled:=true;
S16.Form3.E15_4.Enabled:=true;
S16.Form3.E15_5.Enabled:=true;
S16.Form3.E15_6.Enabled:=true;
S16.Form3.E15_7.Enabled:=true;
S16.Form3.E15_8.Enabled:=true;
S16.Form3.E15_9.Enabled:=true;
S16.Form3.E15_10.Enabled:=true;
S16.Form3.E15_11.Enabled:=true;
S16.Form3.E15_12.Enabled:=true;
S16.Form3.E15_13.Enabled:=true;
S16.Form3.E15_14.Enabled:=true;
S16.Form3.E15_15.Enabled:=true;
S16.Form3.E15_16.Enabled:=true;
S16.Form3.E16_1.Enabled:=true;
S16.Form3.E16_2.Enabled:=true;
S16.Form3.E16_3.Enabled:=true;
S16.Form3.E16_4.Enabled:=true;
S16.Form3.E16_5.Enabled:=true;
S16.Form3.E16_6.Enabled:=true;
S16.Form3.E16_7.Enabled:=true;
S16.Form3.E16_8.Enabled:=true;
S16.Form3.E16_9.Enabled:=true;
S16.Form3.E16_10.Enabled:=true;
S16.Form3.E16_11.Enabled:=true;
S16.Form3.E16_12.Enabled:=true;
S16.Form3.E16_13.Enabled:=true;
S16.Form3.E16_14.Enabled:=true;
S16.Form3.E16_15.Enabled:=true;
S16.Form3.E16_16.Enabled:=true;
End;

Procedure DataToMap;
Begin
S16.Form3.E1_1.Text:=DataToSave[1,1];
S16.Form3.E1_2.Text:=DataToSave[1,2];
S16.Form3.E1_3.Text:=DataToSave[1,3];
S16.Form3.E1_4.Text:=DataToSave[1,4];
S16.Form3.E1_5.Text:=DataToSave[1,5];
S16.Form3.E1_6.Text:=DataToSave[1,6];
S16.Form3.E1_7.Text:=DataToSave[1,7];
S16.Form3.E1_8.Text:=DataToSave[1,8];
S16.Form3.E1_9.Text:=DataToSave[1,9];
S16.Form3.E1_10.Text:=DataToSave[1,10];
S16.Form3.E1_11.Text:=DataToSave[1,11];
S16.Form3.E1_12.Text:=DataToSave[1,12];
S16.Form3.E1_13.Text:=DataToSave[1,13];
S16.Form3.E1_14.Text:=DataToSave[1,14];
S16.Form3.E1_15.Text:=DataToSave[1,15];
S16.Form3.E1_16.Text:=DataToSave[1,16];
S16.Form3.E2_1.Text:=DataToSave[2,1];
S16.Form3.E2_2.Text:=DataToSave[2,2];
S16.Form3.E2_3.Text:=DataToSave[2,3];
S16.Form3.E2_4.Text:=DataToSave[2,4];
S16.Form3.E2_5.Text:=DataToSave[2,5];
S16.Form3.E2_6.Text:=DataToSave[2,6];
S16.Form3.E2_7.Text:=DataToSave[2,7];
S16.Form3.E2_8.Text:=DataToSave[2,8];
S16.Form3.E2_9.Text:=DataToSave[2,9];
S16.Form3.E2_10.Text:=DataToSave[2,10];
S16.Form3.E2_11.Text:=DataToSave[2,11];
S16.Form3.E2_12.Text:=DataToSave[2,12];
S16.Form3.E2_13.Text:=DataToSave[2,13];
S16.Form3.E2_14.Text:=DataToSave[2,14];
S16.Form3.E2_15.Text:=DataToSave[2,15];
S16.Form3.E2_16.Text:=DataToSave[2,16];
S16.Form3.E3_1.Text:=DataToSave[3,1];
S16.Form3.E3_2.Text:=DataToSave[3,2];
S16.Form3.E3_3.Text:=DataToSave[3,3];
S16.Form3.E3_4.Text:=DataToSave[3,4];
S16.Form3.E3_5.Text:=DataToSave[3,5];
S16.Form3.E3_6.Text:=DataToSave[3,6];
S16.Form3.E3_7.Text:=DataToSave[3,7];
S16.Form3.E3_8.Text:=DataToSave[3,8];
S16.Form3.E3_9.Text:=DataToSave[3,9];
S16.Form3.E3_10.Text:=DataToSave[3,10];
S16.Form3.E3_11.Text:=DataToSave[3,11];
S16.Form3.E3_12.Text:=DataToSave[3,12];
S16.Form3.E3_13.Text:=DataToSave[3,13];
S16.Form3.E3_14.Text:=DataToSave[3,14];
S16.Form3.E3_15.Text:=DataToSave[3,15];
S16.Form3.E3_16.Text:=DataToSave[3,16];
S16.Form3.E4_1.Text:=DataToSave[4,1];
S16.Form3.E4_2.Text:=DataToSave[4,2];
S16.Form3.E4_3.Text:=DataToSave[4,3];
S16.Form3.E4_4.Text:=DataToSave[4,4];
S16.Form3.E4_5.Text:=DataToSave[4,5];
S16.Form3.E4_6.Text:=DataToSave[4,6];
S16.Form3.E4_7.Text:=DataToSave[4,7];
S16.Form3.E4_8.Text:=DataToSave[4,8];
S16.Form3.E4_9.Text:=DataToSave[4,9];
S16.Form3.E4_10.Text:=DataToSave[4,10];
S16.Form3.E4_11.Text:=DataToSave[4,11];
S16.Form3.E4_12.Text:=DataToSave[4,12];
S16.Form3.E4_13.Text:=DataToSave[4,13];
S16.Form3.E4_14.Text:=DataToSave[4,14];
S16.Form3.E4_15.Text:=DataToSave[4,15];
S16.Form3.E4_16.Text:=DataToSave[4,16];
S16.Form3.E5_1.Text:=DataToSave[5,1];
S16.Form3.E5_2.Text:=DataToSave[5,2];
S16.Form3.E5_3.Text:=DataToSave[5,3];
S16.Form3.E5_4.Text:=DataToSave[5,4];
S16.Form3.E5_5.Text:=DataToSave[5,5];
S16.Form3.E5_6.Text:=DataToSave[5,6];
S16.Form3.E5_7.Text:=DataToSave[5,7];
S16.Form3.E5_8.Text:=DataToSave[5,8];
S16.Form3.E5_9.Text:=DataToSave[5,9];
S16.Form3.E5_10.Text:=DataToSave[5,10];
S16.Form3.E5_11.Text:=DataToSave[5,11];
S16.Form3.E5_12.Text:=DataToSave[5,12];
S16.Form3.E5_13.Text:=DataToSave[5,13];
S16.Form3.E5_14.Text:=DataToSave[5,14];
S16.Form3.E5_15.Text:=DataToSave[5,15];
S16.Form3.E5_16.Text:=DataToSave[5,16];
S16.Form3.E6_1.Text:=DataToSave[6,1];
S16.Form3.E6_2.Text:=DataToSave[6,2];
S16.Form3.E6_3.Text:=DataToSave[6,3];
S16.Form3.E6_4.Text:=DataToSave[6,4];
S16.Form3.E6_5.Text:=DataToSave[6,5];
S16.Form3.E6_6.Text:=DataToSave[6,6];
S16.Form3.E6_7.Text:=DataToSave[6,7];
S16.Form3.E6_8.Text:=DataToSave[6,8];
S16.Form3.E6_9.Text:=DataToSave[6,9];
S16.Form3.E6_10.Text:=DataToSave[6,10];
S16.Form3.E6_11.Text:=DataToSave[6,11];
S16.Form3.E6_12.Text:=DataToSave[6,12];
S16.Form3.E6_13.Text:=DataToSave[6,13];
S16.Form3.E6_14.Text:=DataToSave[6,14];
S16.Form3.E6_15.Text:=DataToSave[6,15];
S16.Form3.E6_16.Text:=DataToSave[6,16];
S16.Form3.E7_1.Text:=DataToSave[7,1];
S16.Form3.E7_2.Text:=DataToSave[7,2];
S16.Form3.E7_3.Text:=DataToSave[7,3];
S16.Form3.E7_4.Text:=DataToSave[7,4];
S16.Form3.E7_5.Text:=DataToSave[7,5];
S16.Form3.E7_6.Text:=DataToSave[7,6];
S16.Form3.E7_7.Text:=DataToSave[7,7];
S16.Form3.E7_8.Text:=DataToSave[7,8];
S16.Form3.E7_9.Text:=DataToSave[7,9];
S16.Form3.E7_10.Text:=DataToSave[7,10];
S16.Form3.E7_11.Text:=DataToSave[7,11];
S16.Form3.E7_12.Text:=DataToSave[7,12];
S16.Form3.E7_13.Text:=DataToSave[7,13];
S16.Form3.E7_14.Text:=DataToSave[7,14];
S16.Form3.E7_15.Text:=DataToSave[7,15];
S16.Form3.E7_16.Text:=DataToSave[7,16];
S16.Form3.E8_1.Text:=DataToSave[8,1];
S16.Form3.E8_2.Text:=DataToSave[8,2];
S16.Form3.E8_3.Text:=DataToSave[8,3];
S16.Form3.E8_4.Text:=DataToSave[8,4];
S16.Form3.E8_5.Text:=DataToSave[8,5];
S16.Form3.E8_6.Text:=DataToSave[8,6];
S16.Form3.E8_7.Text:=DataToSave[8,7];
S16.Form3.E8_8.Text:=DataToSave[8,8];
S16.Form3.E8_9.Text:=DataToSave[8,9];
S16.Form3.E8_10.Text:=DataToSave[8,10];
S16.Form3.E8_11.Text:=DataToSave[8,11];
S16.Form3.E8_12.Text:=DataToSave[8,12];
S16.Form3.E8_13.Text:=DataToSave[8,13];
S16.Form3.E8_14.Text:=DataToSave[8,14];
S16.Form3.E8_15.Text:=DataToSave[8,15];
S16.Form3.E8_16.Text:=DataToSave[8,16];
S16.Form3.E9_1.Text:=DataToSave[9,1];
S16.Form3.E9_2.Text:=DataToSave[9,2];
S16.Form3.E9_3.Text:=DataToSave[9,3];
S16.Form3.E9_4.Text:=DataToSave[9,4];
S16.Form3.E9_5.Text:=DataToSave[9,5];
S16.Form3.E9_6.Text:=DataToSave[9,6];
S16.Form3.E9_7.Text:=DataToSave[9,7];
S16.Form3.E9_8.Text:=DataToSave[9,8];
S16.Form3.E9_9.Text:=DataToSave[9,9];
S16.Form3.E9_10.Text:=DataToSave[9,10];
S16.Form3.E9_11.Text:=DataToSave[9,11];
S16.Form3.E9_12.Text:=DataToSave[9,12];
S16.Form3.E9_13.Text:=DataToSave[9,13];
S16.Form3.E9_14.Text:=DataToSave[9,14];
S16.Form3.E9_15.Text:=DataToSave[9,15];
S16.Form3.E9_16.Text:=DataToSave[9,16];
S16.Form3.E10_1.Text:=DataToSave[10,1];
S16.Form3.E10_2.Text:=DataToSave[10,2];
S16.Form3.E10_3.Text:=DataToSave[10,3];
S16.Form3.E10_4.Text:=DataToSave[10,4];
S16.Form3.E10_5.Text:=DataToSave[10,5];
S16.Form3.E10_6.Text:=DataToSave[10,6];
S16.Form3.E10_7.Text:=DataToSave[10,7];
S16.Form3.E10_8.Text:=DataToSave[10,8];
S16.Form3.E10_9.Text:=DataToSave[10,9];
S16.Form3.E10_10.Text:=DataToSave[10,10];
S16.Form3.E10_11.Text:=DataToSave[10,11];
S16.Form3.E10_12.Text:=DataToSave[10,12];
S16.Form3.E10_13.Text:=DataToSave[10,13];
S16.Form3.E10_14.Text:=DataToSave[10,14];
S16.Form3.E10_15.Text:=DataToSave[10,15];
S16.Form3.E10_16.Text:=DataToSave[10,16];
S16.Form3.E11_1.Text:=DataToSave[11,1];
S16.Form3.E11_2.Text:=DataToSave[11,2];
S16.Form3.E11_3.Text:=DataToSave[11,3];
S16.Form3.E11_4.Text:=DataToSave[11,4];
S16.Form3.E11_5.Text:=DataToSave[11,5];
S16.Form3.E11_6.Text:=DataToSave[11,6];
S16.Form3.E11_7.Text:=DataToSave[11,7];
S16.Form3.E11_8.Text:=DataToSave[11,8];
S16.Form3.E11_9.Text:=DataToSave[11,9];
S16.Form3.E11_10.Text:=DataToSave[11,10];
S16.Form3.E11_11.Text:=DataToSave[11,11];
S16.Form3.E11_12.Text:=DataToSave[11,12];
S16.Form3.E11_13.Text:=DataToSave[11,13];
S16.Form3.E11_14.Text:=DataToSave[11,14];
S16.Form3.E11_15.Text:=DataToSave[11,15];
S16.Form3.E11_16.Text:=DataToSave[11,16];
S16.Form3.E12_1.Text:=DataToSave[12,1];
S16.Form3.E12_2.Text:=DataToSave[12,2];
S16.Form3.E12_3.Text:=DataToSave[12,3];
S16.Form3.E12_4.Text:=DataToSave[12,4];
S16.Form3.E12_5.Text:=DataToSave[12,5];
S16.Form3.E12_6.Text:=DataToSave[12,6];
S16.Form3.E12_7.Text:=DataToSave[12,7];
S16.Form3.E12_8.Text:=DataToSave[12,8];
S16.Form3.E12_9.Text:=DataToSave[12,9];
S16.Form3.E12_10.Text:=DataToSave[12,10];
S16.Form3.E12_11.Text:=DataToSave[12,11];
S16.Form3.E12_12.Text:=DataToSave[12,12];
S16.Form3.E12_13.Text:=DataToSave[12,13];
S16.Form3.E12_14.Text:=DataToSave[12,14];
S16.Form3.E12_15.Text:=DataToSave[12,15];
S16.Form3.E12_16.Text:=DataToSave[12,16];
S16.Form3.E13_1.Text:=DataToSave[13,1];
S16.Form3.E13_2.Text:=DataToSave[13,2];
S16.Form3.E13_3.Text:=DataToSave[13,3];
S16.Form3.E13_4.Text:=DataToSave[13,4];
S16.Form3.E13_5.Text:=DataToSave[13,5];
S16.Form3.E13_6.Text:=DataToSave[13,6];
S16.Form3.E13_7.Text:=DataToSave[13,7];
S16.Form3.E13_8.Text:=DataToSave[13,8];
S16.Form3.E13_9.Text:=DataToSave[13,9];
S16.Form3.E13_10.Text:=DataToSave[13,10];
S16.Form3.E13_11.Text:=DataToSave[13,11];
S16.Form3.E13_12.Text:=DataToSave[13,12];
S16.Form3.E13_13.Text:=DataToSave[13,13];
S16.Form3.E13_14.Text:=DataToSave[13,14];
S16.Form3.E13_15.Text:=DataToSave[13,15];
S16.Form3.E13_16.Text:=DataToSave[13,16];
S16.Form3.E14_1.Text:=DataToSave[14,1];
S16.Form3.E14_2.Text:=DataToSave[14,2];
S16.Form3.E14_3.Text:=DataToSave[14,3];
S16.Form3.E14_4.Text:=DataToSave[14,4];
S16.Form3.E14_5.Text:=DataToSave[14,5];
S16.Form3.E14_6.Text:=DataToSave[14,6];
S16.Form3.E14_7.Text:=DataToSave[14,7];
S16.Form3.E14_8.Text:=DataToSave[14,8];
S16.Form3.E14_9.Text:=DataToSave[14,9];
S16.Form3.E14_10.Text:=DataToSave[14,10];
S16.Form3.E14_11.Text:=DataToSave[14,11];
S16.Form3.E14_12.Text:=DataToSave[14,12];
S16.Form3.E14_13.Text:=DataToSave[14,13];
S16.Form3.E14_14.Text:=DataToSave[14,14];
S16.Form3.E14_15.Text:=DataToSave[14,15];
S16.Form3.E14_16.Text:=DataToSave[14,16];
S16.Form3.E15_1.Text:=DataToSave[15,1];
S16.Form3.E15_2.Text:=DataToSave[15,2];
S16.Form3.E15_3.Text:=DataToSave[15,3];
S16.Form3.E15_4.Text:=DataToSave[15,4];
S16.Form3.E15_5.Text:=DataToSave[15,5];
S16.Form3.E15_6.Text:=DataToSave[15,6];
S16.Form3.E15_7.Text:=DataToSave[15,7];
S16.Form3.E15_8.Text:=DataToSave[15,8];
S16.Form3.E15_9.Text:=DataToSave[15,9];
S16.Form3.E15_10.Text:=DataToSave[15,10];
S16.Form3.E15_11.Text:=DataToSave[15,11];
S16.Form3.E15_12.Text:=DataToSave[15,12];
S16.Form3.E15_13.Text:=DataToSave[15,13];
S16.Form3.E15_14.Text:=DataToSave[15,14];
S16.Form3.E15_15.Text:=DataToSave[15,15];
S16.Form3.E15_16.Text:=DataToSave[15,16];
S16.Form3.E16_1.Text:=DataToSave[16,1];
S16.Form3.E16_2.Text:=DataToSave[16,2];
S16.Form3.E16_3.Text:=DataToSave[16,3];
S16.Form3.E16_4.Text:=DataToSave[16,4];
S16.Form3.E16_5.Text:=DataToSave[16,5];
S16.Form3.E16_6.Text:=DataToSave[16,6];
S16.Form3.E16_7.Text:=DataToSave[16,7];
S16.Form3.E16_8.Text:=DataToSave[16,8];
S16.Form3.E16_9.Text:=DataToSave[16,9];
S16.Form3.E16_10.Text:=DataToSave[16,10];
S16.Form3.E16_11.Text:=DataToSave[16,11];
S16.Form3.E16_12.Text:=DataToSave[16,12];
S16.Form3.E16_13.Text:=DataToSave[16,13];
S16.Form3.E16_14.Text:=DataToSave[16,14];
S16.Form3.E16_15.Text:=DataToSave[16,15];
S16.Form3.E16_16.Text:=DataToSave[16,16];
End;

Procedure CreateMap;
Var
  i,j,l,e:byte;
Begin
  Randomize;
  l:=S16.Form3.ComboBox1.ItemIndex;
  Case l of
    0: e:=100;
    1: e:=125;
    2: e:=141;
    3: e:=158;
    4: e:=180;
  end;

  l:=0;
  repeat
  i:=random(16)+1;
  j:=random(16)+1;
  if map[i,j]<>'H' then
  begin
    map[i,j]:='H';
    map[17-i,17-j]:='H';
    if (17-i=i)and(17-j=j) then inc(l)
      else l:=l+2;
  end;
  until (l>e);

End;

Procedure FullClear;
Begin
S16.Form3.E1_1.Text:='';
S16.Form3.E1_2.Text:='';
S16.Form3.E1_3.Text:='';
S16.Form3.E1_4.Text:='';
S16.Form3.E1_5.Text:='';
S16.Form3.E1_6.Text:='';
S16.Form3.E1_7.Text:='';
S16.Form3.E1_8.Text:='';
S16.Form3.E1_9.Text:='';
S16.Form3.E1_10.Text:='';
S16.Form3.E1_11.Text:='';
S16.Form3.E1_12.Text:='';
S16.Form3.E1_13.Text:='';
S16.Form3.E1_14.Text:='';
S16.Form3.E1_15.Text:='';
S16.Form3.E1_16.Text:='';
S16.Form3.E2_1.Text:='';
S16.Form3.E2_2.Text:='';
S16.Form3.E2_3.Text:='';
S16.Form3.E2_4.Text:='';
S16.Form3.E2_5.Text:='';
S16.Form3.E2_6.Text:='';
S16.Form3.E2_7.Text:='';
S16.Form3.E2_8.Text:='';
S16.Form3.E2_9.Text:='';
S16.Form3.E2_10.Text:='';
S16.Form3.E2_11.Text:='';
S16.Form3.E2_12.Text:='';
S16.Form3.E2_13.Text:='';
S16.Form3.E2_14.Text:='';
S16.Form3.E2_15.Text:='';
S16.Form3.E2_16.Text:='';
S16.Form3.E3_1.Text:='';
S16.Form3.E3_2.Text:='';
S16.Form3.E3_3.Text:='';
S16.Form3.E3_4.Text:='';
S16.Form3.E3_5.Text:='';
S16.Form3.E3_6.Text:='';
S16.Form3.E3_7.Text:='';
S16.Form3.E3_8.Text:='';
S16.Form3.E3_9.Text:='';
S16.Form3.E3_10.Text:='';
S16.Form3.E3_11.Text:='';
S16.Form3.E3_12.Text:='';
S16.Form3.E3_13.Text:='';
S16.Form3.E3_14.Text:='';
S16.Form3.E3_15.Text:='';
S16.Form3.E3_16.Text:='';
S16.Form3.E4_1.Text:='';
S16.Form3.E4_2.Text:='';
S16.Form3.E4_3.Text:='';
S16.Form3.E4_4.Text:='';
S16.Form3.E4_5.Text:='';
S16.Form3.E4_6.Text:='';
S16.Form3.E4_7.Text:='';
S16.Form3.E4_8.Text:='';
S16.Form3.E4_9.Text:='';
S16.Form3.E4_10.Text:='';
S16.Form3.E4_11.Text:='';
S16.Form3.E4_12.Text:='';
S16.Form3.E4_13.Text:='';
S16.Form3.E4_14.Text:='';
S16.Form3.E4_15.Text:='';
S16.Form3.E4_16.Text:='';
S16.Form3.E5_1.Text:='';
S16.Form3.E5_2.Text:='';
S16.Form3.E5_3.Text:='';
S16.Form3.E5_4.Text:='';
S16.Form3.E5_5.Text:='';
S16.Form3.E5_6.Text:='';
S16.Form3.E5_7.Text:='';
S16.Form3.E5_8.Text:='';
S16.Form3.E5_9.Text:='';
S16.Form3.E5_10.Text:='';
S16.Form3.E5_11.Text:='';
S16.Form3.E5_12.Text:='';
S16.Form3.E5_13.Text:='';
S16.Form3.E5_14.Text:='';
S16.Form3.E5_15.Text:='';
S16.Form3.E5_16.Text:='';
S16.Form3.E6_1.Text:='';
S16.Form3.E6_2.Text:='';
S16.Form3.E6_3.Text:='';
S16.Form3.E6_4.Text:='';
S16.Form3.E6_5.Text:='';
S16.Form3.E6_6.Text:='';
S16.Form3.E6_7.Text:='';
S16.Form3.E6_8.Text:='';
S16.Form3.E6_9.Text:='';
S16.Form3.E6_10.Text:='';
S16.Form3.E6_11.Text:='';
S16.Form3.E6_12.Text:='';
S16.Form3.E6_13.Text:='';
S16.Form3.E6_14.Text:='';
S16.Form3.E6_15.Text:='';
S16.Form3.E6_16.Text:='';
S16.Form3.E7_1.Text:='';
S16.Form3.E7_2.Text:='';
S16.Form3.E7_3.Text:='';
S16.Form3.E7_4.Text:='';
S16.Form3.E7_5.Text:='';
S16.Form3.E7_6.Text:='';
S16.Form3.E7_7.Text:='';
S16.Form3.E7_8.Text:='';
S16.Form3.E7_9.Text:='';
S16.Form3.E7_10.Text:='';
S16.Form3.E7_11.Text:='';
S16.Form3.E7_12.Text:='';
S16.Form3.E7_13.Text:='';
S16.Form3.E7_14.Text:='';
S16.Form3.E7_15.Text:='';
S16.Form3.E7_16.Text:='';
S16.Form3.E8_1.Text:='';
S16.Form3.E8_2.Text:='';
S16.Form3.E8_3.Text:='';
S16.Form3.E8_4.Text:='';
S16.Form3.E8_5.Text:='';
S16.Form3.E8_6.Text:='';
S16.Form3.E8_7.Text:='';
S16.Form3.E8_8.Text:='';
S16.Form3.E8_9.Text:='';
S16.Form3.E8_10.Text:='';
S16.Form3.E8_11.Text:='';
S16.Form3.E8_12.Text:='';
S16.Form3.E8_13.Text:='';
S16.Form3.E8_14.Text:='';
S16.Form3.E8_15.Text:='';
S16.Form3.E8_16.Text:='';
S16.Form3.E9_1.Text:='';
S16.Form3.E9_2.Text:='';
S16.Form3.E9_3.Text:='';
S16.Form3.E9_4.Text:='';
S16.Form3.E9_5.Text:='';
S16.Form3.E9_6.Text:='';
S16.Form3.E9_7.Text:='';
S16.Form3.E9_8.Text:='';
S16.Form3.E9_9.Text:='';
S16.Form3.E9_10.Text:='';
S16.Form3.E9_11.Text:='';
S16.Form3.E9_12.Text:='';
S16.Form3.E9_13.Text:='';
S16.Form3.E9_14.Text:='';
S16.Form3.E9_15.Text:='';
S16.Form3.E9_16.Text:='';
S16.Form3.E10_1.Text:='';
S16.Form3.E10_2.Text:='';
S16.Form3.E10_3.Text:='';
S16.Form3.E10_4.Text:='';
S16.Form3.E10_5.Text:='';
S16.Form3.E10_6.Text:='';
S16.Form3.E10_7.Text:='';
S16.Form3.E10_8.Text:='';
S16.Form3.E10_9.Text:='';
S16.Form3.E10_10.Text:='';
S16.Form3.E10_11.Text:='';
S16.Form3.E10_12.Text:='';
S16.Form3.E10_13.Text:='';
S16.Form3.E10_14.Text:='';
S16.Form3.E10_15.Text:='';
S16.Form3.E10_16.Text:='';
S16.Form3.E11_1.Text:='';
S16.Form3.E11_2.Text:='';
S16.Form3.E11_3.Text:='';
S16.Form3.E11_4.Text:='';
S16.Form3.E11_5.Text:='';
S16.Form3.E11_6.Text:='';
S16.Form3.E11_7.Text:='';
S16.Form3.E11_8.Text:='';
S16.Form3.E11_9.Text:='';
S16.Form3.E11_10.Text:='';
S16.Form3.E11_11.Text:='';
S16.Form3.E11_12.Text:='';
S16.Form3.E11_13.Text:='';
S16.Form3.E11_14.Text:='';
S16.Form3.E11_15.Text:='';
S16.Form3.E11_16.Text:='';
S16.Form3.E12_1.Text:='';
S16.Form3.E12_2.Text:='';
S16.Form3.E12_3.Text:='';
S16.Form3.E12_4.Text:='';
S16.Form3.E12_5.Text:='';
S16.Form3.E12_6.Text:='';
S16.Form3.E12_7.Text:='';
S16.Form3.E12_8.Text:='';
S16.Form3.E12_9.Text:='';
S16.Form3.E12_10.Text:='';
S16.Form3.E12_11.Text:='';
S16.Form3.E12_12.Text:='';
S16.Form3.E12_13.Text:='';
S16.Form3.E12_14.Text:='';
S16.Form3.E12_15.Text:='';
S16.Form3.E12_16.Text:='';
S16.Form3.E13_1.Text:='';
S16.Form3.E13_2.Text:='';
S16.Form3.E13_3.Text:='';
S16.Form3.E13_4.Text:='';
S16.Form3.E13_5.Text:='';
S16.Form3.E13_6.Text:='';
S16.Form3.E13_7.Text:='';
S16.Form3.E13_8.Text:='';
S16.Form3.E13_9.Text:='';
S16.Form3.E13_10.Text:='';
S16.Form3.E13_11.Text:='';
S16.Form3.E13_12.Text:='';
S16.Form3.E13_13.Text:='';
S16.Form3.E13_14.Text:='';
S16.Form3.E13_15.Text:='';
S16.Form3.E13_16.Text:='';
S16.Form3.E14_1.Text:='';
S16.Form3.E14_2.Text:='';
S16.Form3.E14_3.Text:='';
S16.Form3.E14_4.Text:='';
S16.Form3.E14_5.Text:='';
S16.Form3.E14_6.Text:='';
S16.Form3.E14_7.Text:='';
S16.Form3.E14_8.Text:='';
S16.Form3.E14_9.Text:='';
S16.Form3.E14_10.Text:='';
S16.Form3.E14_11.Text:='';
S16.Form3.E14_12.Text:='';
S16.Form3.E14_13.Text:='';
S16.Form3.E14_14.Text:='';
S16.Form3.E14_15.Text:='';
S16.Form3.E14_16.Text:='';
S16.Form3.E15_1.Text:='';
S16.Form3.E15_2.Text:='';
S16.Form3.E15_3.Text:='';
S16.Form3.E15_4.Text:='';
S16.Form3.E15_5.Text:='';
S16.Form3.E15_6.Text:='';
S16.Form3.E15_7.Text:='';
S16.Form3.E15_8.Text:='';
S16.Form3.E15_9.Text:='';
S16.Form3.E15_10.Text:='';
S16.Form3.E15_11.Text:='';
S16.Form3.E15_12.Text:='';
S16.Form3.E15_13.Text:='';
S16.Form3.E15_14.Text:='';
S16.Form3.E15_15.Text:='';
S16.Form3.E15_16.Text:='';
S16.Form3.E16_1.Text:='';
S16.Form3.E16_2.Text:='';
S16.Form3.E16_3.Text:='';
S16.Form3.E16_4.Text:='';
S16.Form3.E16_5.Text:='';
S16.Form3.E16_6.Text:='';
S16.Form3.E16_7.Text:='';
S16.Form3.E16_8.Text:='';
S16.Form3.E16_9.Text:='';
S16.Form3.E16_10.Text:='';
S16.Form3.E16_11.Text:='';
S16.Form3.E16_12.Text:='';
S16.Form3.E16_13.Text:='';
S16.Form3.E16_14.Text:='';
S16.Form3.E16_15.Text:='';
S16.Form3.E16_16.Text:='';
End;

Procedure ClearMap;
Begin
If S16.Form3.E1_1.Text='H' then S16.Form3.E1_1.Text:=''
  else S16.Form3.E1_1.Enabled:=False;
If S16.Form3.E1_2.Text='H' then S16.Form3.E1_2.Text:=''
  else S16.Form3.E1_2.Enabled:=False;
If S16.Form3.E1_3.Text='H' then S16.Form3.E1_3.Text:=''
  else S16.Form3.E1_3.Enabled:=False;
If S16.Form3.E1_4.Text='H' then S16.Form3.E1_4.Text:=''
  else S16.Form3.E1_4.Enabled:=False;
If S16.Form3.E1_5.Text='H' then S16.Form3.E1_5.Text:=''
  else S16.Form3.E1_5.Enabled:=False;
If S16.Form3.E1_6.Text='H' then S16.Form3.E1_6.Text:=''
  else S16.Form3.E1_6.Enabled:=False;
If S16.Form3.E1_7.Text='H' then S16.Form3.E1_7.Text:=''
  else S16.Form3.E1_7.Enabled:=False;
If S16.Form3.E1_8.Text='H' then S16.Form3.E1_8.Text:=''
  else S16.Form3.E1_8.Enabled:=False;
If S16.Form3.E1_9.Text='H' then S16.Form3.E1_9.Text:=''
  else S16.Form3.E1_9.Enabled:=False;
If S16.Form3.E1_10.Text='H' then S16.Form3.E1_10.Text:=''
  else S16.Form3.E1_10.Enabled:=False;
If S16.Form3.E1_11.Text='H' then S16.Form3.E1_11.Text:=''
  else S16.Form3.E1_11.Enabled:=False;
If S16.Form3.E1_12.Text='H' then S16.Form3.E1_12.Text:=''
  else S16.Form3.E1_12.Enabled:=False;
If S16.Form3.E1_13.Text='H' then S16.Form3.E1_13.Text:=''
  else S16.Form3.E1_13.Enabled:=False;
If S16.Form3.E1_14.Text='H' then S16.Form3.E1_14.Text:=''
  else S16.Form3.E1_14.Enabled:=False;
If S16.Form3.E1_15.Text='H' then S16.Form3.E1_15.Text:=''
  else S16.Form3.E1_15.Enabled:=False;
If S16.Form3.E1_16.Text='H' then S16.Form3.E1_16.Text:=''
  else S16.Form3.E1_16.Enabled:=False;
If S16.Form3.E2_1.Text='H' then S16.Form3.E2_1.Text:=''
  else S16.Form3.E2_1.Enabled:=False;
If S16.Form3.E2_2.Text='H' then S16.Form3.E2_2.Text:=''
  else S16.Form3.E2_2.Enabled:=False;
If S16.Form3.E2_3.Text='H' then S16.Form3.E2_3.Text:=''
  else S16.Form3.E2_3.Enabled:=False;
If S16.Form3.E2_4.Text='H' then S16.Form3.E2_4.Text:=''
  else S16.Form3.E2_4.Enabled:=False;
If S16.Form3.E2_5.Text='H' then S16.Form3.E2_5.Text:=''
  else S16.Form3.E2_5.Enabled:=False;
If S16.Form3.E2_6.Text='H' then S16.Form3.E2_6.Text:=''
  else S16.Form3.E2_6.Enabled:=False;
If S16.Form3.E2_7.Text='H' then S16.Form3.E2_7.Text:=''
  else S16.Form3.E2_7.Enabled:=False;
If S16.Form3.E2_8.Text='H' then S16.Form3.E2_8.Text:=''
  else S16.Form3.E2_8.Enabled:=False;
If S16.Form3.E2_9.Text='H' then S16.Form3.E2_9.Text:=''
  else S16.Form3.E2_9.Enabled:=False;
If S16.Form3.E2_10.Text='H' then S16.Form3.E2_10.Text:=''
  else S16.Form3.E2_10.Enabled:=False;
If S16.Form3.E2_11.Text='H' then S16.Form3.E2_11.Text:=''
  else S16.Form3.E2_11.Enabled:=False;
If S16.Form3.E2_12.Text='H' then S16.Form3.E2_12.Text:=''
  else S16.Form3.E2_12.Enabled:=False;
If S16.Form3.E2_13.Text='H' then S16.Form3.E2_13.Text:=''
  else S16.Form3.E2_13.Enabled:=False;
If S16.Form3.E2_14.Text='H' then S16.Form3.E2_14.Text:=''
  else S16.Form3.E2_14.Enabled:=False;
If S16.Form3.E2_15.Text='H' then S16.Form3.E2_15.Text:=''
  else S16.Form3.E2_15.Enabled:=False;
If S16.Form3.E2_16.Text='H' then S16.Form3.E2_16.Text:=''
  else S16.Form3.E2_16.Enabled:=False;
If S16.Form3.E3_1.Text='H' then S16.Form3.E3_1.Text:=''
  else S16.Form3.E3_1.Enabled:=False;
If S16.Form3.E3_2.Text='H' then S16.Form3.E3_2.Text:=''
  else S16.Form3.E3_2.Enabled:=False;
If S16.Form3.E3_3.Text='H' then S16.Form3.E3_3.Text:=''
  else S16.Form3.E3_3.Enabled:=False;
If S16.Form3.E3_4.Text='H' then S16.Form3.E3_4.Text:=''
  else S16.Form3.E3_4.Enabled:=False;
If S16.Form3.E3_5.Text='H' then S16.Form3.E3_5.Text:=''
  else S16.Form3.E3_5.Enabled:=False;
If S16.Form3.E3_6.Text='H' then S16.Form3.E3_6.Text:=''
  else S16.Form3.E3_6.Enabled:=False;
If S16.Form3.E3_7.Text='H' then S16.Form3.E3_7.Text:=''
  else S16.Form3.E3_7.Enabled:=False;
If S16.Form3.E3_8.Text='H' then S16.Form3.E3_8.Text:=''
  else S16.Form3.E3_8.Enabled:=False;
If S16.Form3.E3_9.Text='H' then S16.Form3.E3_9.Text:=''
  else S16.Form3.E3_9.Enabled:=False;
If S16.Form3.E3_10.Text='H' then S16.Form3.E3_10.Text:=''
  else S16.Form3.E3_10.Enabled:=False;
If S16.Form3.E3_11.Text='H' then S16.Form3.E3_11.Text:=''
  else S16.Form3.E3_11.Enabled:=False;
If S16.Form3.E3_12.Text='H' then S16.Form3.E3_12.Text:=''
  else S16.Form3.E3_12.Enabled:=False;
If S16.Form3.E3_13.Text='H' then S16.Form3.E3_13.Text:=''
  else S16.Form3.E3_13.Enabled:=False;
If S16.Form3.E3_14.Text='H' then S16.Form3.E3_14.Text:=''
  else S16.Form3.E3_14.Enabled:=False;
If S16.Form3.E3_15.Text='H' then S16.Form3.E3_15.Text:=''
  else S16.Form3.E3_15.Enabled:=False;
If S16.Form3.E3_16.Text='H' then S16.Form3.E3_16.Text:=''
  else S16.Form3.E3_16.Enabled:=False;
If S16.Form3.E4_1.Text='H' then S16.Form3.E4_1.Text:=''
  else S16.Form3.E4_1.Enabled:=False;
If S16.Form3.E4_2.Text='H' then S16.Form3.E4_2.Text:=''
  else S16.Form3.E4_2.Enabled:=False;
If S16.Form3.E4_3.Text='H' then S16.Form3.E4_3.Text:=''
  else S16.Form3.E4_3.Enabled:=False;
If S16.Form3.E4_4.Text='H' then S16.Form3.E4_4.Text:=''
  else S16.Form3.E4_4.Enabled:=False;
If S16.Form3.E4_5.Text='H' then S16.Form3.E4_5.Text:=''
  else S16.Form3.E4_5.Enabled:=False;
If S16.Form3.E4_6.Text='H' then S16.Form3.E4_6.Text:=''
  else S16.Form3.E4_6.Enabled:=False;
If S16.Form3.E4_7.Text='H' then S16.Form3.E4_7.Text:=''
  else S16.Form3.E4_7.Enabled:=False;
If S16.Form3.E4_8.Text='H' then S16.Form3.E4_8.Text:=''
  else S16.Form3.E4_8.Enabled:=False;
If S16.Form3.E4_9.Text='H' then S16.Form3.E4_9.Text:=''
  else S16.Form3.E4_9.Enabled:=False;
If S16.Form3.E4_10.Text='H' then S16.Form3.E4_10.Text:=''
  else S16.Form3.E4_10.Enabled:=False;
If S16.Form3.E4_11.Text='H' then S16.Form3.E4_11.Text:=''
  else S16.Form3.E4_11.Enabled:=False;
If S16.Form3.E4_12.Text='H' then S16.Form3.E4_12.Text:=''
  else S16.Form3.E4_12.Enabled:=False;
If S16.Form3.E4_13.Text='H' then S16.Form3.E4_13.Text:=''
  else S16.Form3.E4_13.Enabled:=False;
If S16.Form3.E4_14.Text='H' then S16.Form3.E4_14.Text:=''
  else S16.Form3.E4_14.Enabled:=False;
If S16.Form3.E4_15.Text='H' then S16.Form3.E4_15.Text:=''
  else S16.Form3.E4_15.Enabled:=False;
If S16.Form3.E4_16.Text='H' then S16.Form3.E4_16.Text:=''
  else S16.Form3.E4_16.Enabled:=False;
If S16.Form3.E5_1.Text='H' then S16.Form3.E5_1.Text:=''
  else S16.Form3.E5_1.Enabled:=False;
If S16.Form3.E5_2.Text='H' then S16.Form3.E5_2.Text:=''
  else S16.Form3.E5_2.Enabled:=False;
If S16.Form3.E5_3.Text='H' then S16.Form3.E5_3.Text:=''
  else S16.Form3.E5_3.Enabled:=False;
If S16.Form3.E5_4.Text='H' then S16.Form3.E5_4.Text:=''
  else S16.Form3.E5_4.Enabled:=False;
If S16.Form3.E5_5.Text='H' then S16.Form3.E5_5.Text:=''
  else S16.Form3.E5_5.Enabled:=False;
If S16.Form3.E5_6.Text='H' then S16.Form3.E5_6.Text:=''
  else S16.Form3.E5_6.Enabled:=False;
If S16.Form3.E5_7.Text='H' then S16.Form3.E5_7.Text:=''
  else S16.Form3.E5_7.Enabled:=False;
If S16.Form3.E5_8.Text='H' then S16.Form3.E5_8.Text:=''
  else S16.Form3.E5_8.Enabled:=False;
If S16.Form3.E5_9.Text='H' then S16.Form3.E5_9.Text:=''
  else S16.Form3.E5_9.Enabled:=False;
If S16.Form3.E5_10.Text='H' then S16.Form3.E5_10.Text:=''
  else S16.Form3.E5_10.Enabled:=False;
If S16.Form3.E5_11.Text='H' then S16.Form3.E5_11.Text:=''
  else S16.Form3.E5_11.Enabled:=False;
If S16.Form3.E5_12.Text='H' then S16.Form3.E5_12.Text:=''
  else S16.Form3.E5_12.Enabled:=False;
If S16.Form3.E5_13.Text='H' then S16.Form3.E5_13.Text:=''
  else S16.Form3.E5_13.Enabled:=False;
If S16.Form3.E5_14.Text='H' then S16.Form3.E5_14.Text:=''
  else S16.Form3.E5_14.Enabled:=False;
If S16.Form3.E5_15.Text='H' then S16.Form3.E5_15.Text:=''
  else S16.Form3.E5_15.Enabled:=False;
If S16.Form3.E5_16.Text='H' then S16.Form3.E5_16.Text:=''
  else S16.Form3.E5_16.Enabled:=False;
If S16.Form3.E6_1.Text='H' then S16.Form3.E6_1.Text:=''
  else S16.Form3.E6_1.Enabled:=False;
If S16.Form3.E6_2.Text='H' then S16.Form3.E6_2.Text:=''
  else S16.Form3.E6_2.Enabled:=False;
If S16.Form3.E6_3.Text='H' then S16.Form3.E6_3.Text:=''
  else S16.Form3.E6_3.Enabled:=False;
If S16.Form3.E6_4.Text='H' then S16.Form3.E6_4.Text:=''
  else S16.Form3.E6_4.Enabled:=False;
If S16.Form3.E6_5.Text='H' then S16.Form3.E6_5.Text:=''
  else S16.Form3.E6_5.Enabled:=False;
If S16.Form3.E6_6.Text='H' then S16.Form3.E6_6.Text:=''
  else S16.Form3.E6_6.Enabled:=False;
If S16.Form3.E6_7.Text='H' then S16.Form3.E6_7.Text:=''
  else S16.Form3.E6_7.Enabled:=False;
If S16.Form3.E6_8.Text='H' then S16.Form3.E6_8.Text:=''
  else S16.Form3.E6_8.Enabled:=False;
If S16.Form3.E6_9.Text='H' then S16.Form3.E6_9.Text:=''
  else S16.Form3.E6_9.Enabled:=False;
If S16.Form3.E6_10.Text='H' then S16.Form3.E6_10.Text:=''
  else S16.Form3.E6_10.Enabled:=False;
If S16.Form3.E6_11.Text='H' then S16.Form3.E6_11.Text:=''
  else S16.Form3.E6_11.Enabled:=False;
If S16.Form3.E6_12.Text='H' then S16.Form3.E6_12.Text:=''
  else S16.Form3.E6_12.Enabled:=False;
If S16.Form3.E6_13.Text='H' then S16.Form3.E6_13.Text:=''
  else S16.Form3.E6_13.Enabled:=False;
If S16.Form3.E6_14.Text='H' then S16.Form3.E6_14.Text:=''
  else S16.Form3.E6_14.Enabled:=False;
If S16.Form3.E6_15.Text='H' then S16.Form3.E6_15.Text:=''
  else S16.Form3.E6_15.Enabled:=False;
If S16.Form3.E6_16.Text='H' then S16.Form3.E6_16.Text:=''
  else S16.Form3.E6_16.Enabled:=False;
If S16.Form3.E7_1.Text='H' then S16.Form3.E7_1.Text:=''
  else S16.Form3.E7_1.Enabled:=False;
If S16.Form3.E7_2.Text='H' then S16.Form3.E7_2.Text:=''
  else S16.Form3.E7_2.Enabled:=False;
If S16.Form3.E7_3.Text='H' then S16.Form3.E7_3.Text:=''
  else S16.Form3.E7_3.Enabled:=False;
If S16.Form3.E7_4.Text='H' then S16.Form3.E7_4.Text:=''
  else S16.Form3.E7_4.Enabled:=False;
If S16.Form3.E7_5.Text='H' then S16.Form3.E7_5.Text:=''
  else S16.Form3.E7_5.Enabled:=False;
If S16.Form3.E7_6.Text='H' then S16.Form3.E7_6.Text:=''
  else S16.Form3.E7_6.Enabled:=False;
If S16.Form3.E7_7.Text='H' then S16.Form3.E7_7.Text:=''
  else S16.Form3.E7_7.Enabled:=False;
If S16.Form3.E7_8.Text='H' then S16.Form3.E7_8.Text:=''
  else S16.Form3.E7_8.Enabled:=False;
If S16.Form3.E7_9.Text='H' then S16.Form3.E7_9.Text:=''
  else S16.Form3.E7_9.Enabled:=False;
If S16.Form3.E7_10.Text='H' then S16.Form3.E7_10.Text:=''
  else S16.Form3.E7_10.Enabled:=False;
If S16.Form3.E7_11.Text='H' then S16.Form3.E7_11.Text:=''
  else S16.Form3.E7_11.Enabled:=False;
If S16.Form3.E7_12.Text='H' then S16.Form3.E7_12.Text:=''
  else S16.Form3.E7_12.Enabled:=False;
If S16.Form3.E7_13.Text='H' then S16.Form3.E7_13.Text:=''
  else S16.Form3.E7_13.Enabled:=False;
If S16.Form3.E7_14.Text='H' then S16.Form3.E7_14.Text:=''
  else S16.Form3.E7_14.Enabled:=False;
If S16.Form3.E7_15.Text='H' then S16.Form3.E7_15.Text:=''
  else S16.Form3.E7_15.Enabled:=False;
If S16.Form3.E7_16.Text='H' then S16.Form3.E7_16.Text:=''
  else S16.Form3.E7_16.Enabled:=False;
  If S16.Form3.E8_1.Text='H' then S16.Form3.E8_1.Text:=''
  else S16.Form3.E8_1.Enabled:=False;
If S16.Form3.E8_2.Text='H' then S16.Form3.E8_2.Text:=''
  else S16.Form3.E8_2.Enabled:=False;
If S16.Form3.E8_3.Text='H' then S16.Form3.E8_3.Text:=''
  else S16.Form3.E8_3.Enabled:=False;
If S16.Form3.E8_4.Text='H' then S16.Form3.E8_4.Text:=''
  else S16.Form3.E8_4.Enabled:=False;
If S16.Form3.E8_5.Text='H' then S16.Form3.E8_5.Text:=''
  else S16.Form3.E8_5.Enabled:=False;
If S16.Form3.E8_6.Text='H' then S16.Form3.E8_6.Text:=''
  else S16.Form3.E8_6.Enabled:=False;
If S16.Form3.E8_7.Text='H' then S16.Form3.E8_7.Text:=''
  else S16.Form3.E8_7.Enabled:=False;
If S16.Form3.E8_8.Text='H' then S16.Form3.E8_8.Text:=''
  else S16.Form3.E8_8.Enabled:=False;
If S16.Form3.E8_9.Text='H' then S16.Form3.E8_9.Text:=''
  else S16.Form3.E8_9.Enabled:=False;
If S16.Form3.E8_10.Text='H' then S16.Form3.E8_10.Text:=''
  else S16.Form3.E8_10.Enabled:=False;
If S16.Form3.E8_11.Text='H' then S16.Form3.E8_11.Text:=''
  else S16.Form3.E8_11.Enabled:=False;
If S16.Form3.E8_12.Text='H' then S16.Form3.E8_12.Text:=''
  else S16.Form3.E8_12.Enabled:=False;
If S16.Form3.E8_13.Text='H' then S16.Form3.E8_13.Text:=''
  else S16.Form3.E8_13.Enabled:=False;
If S16.Form3.E8_14.Text='H' then S16.Form3.E8_14.Text:=''
  else S16.Form3.E8_14.Enabled:=False;
If S16.Form3.E8_15.Text='H' then S16.Form3.E8_15.Text:=''
  else S16.Form3.E8_15.Enabled:=False;
If S16.Form3.E8_16.Text='H' then S16.Form3.E8_16.Text:=''
  else S16.Form3.E8_16.Enabled:=False;
If S16.Form3.E9_1.Text='H' then S16.Form3.E9_1.Text:=''
  else S16.Form3.E9_1.Enabled:=False;
If S16.Form3.E9_2.Text='H' then S16.Form3.E9_2.Text:=''
  else S16.Form3.E9_2.Enabled:=False;
If S16.Form3.E9_3.Text='H' then S16.Form3.E9_3.Text:=''
  else S16.Form3.E9_3.Enabled:=False;
If S16.Form3.E9_4.Text='H' then S16.Form3.E9_4.Text:=''
  else S16.Form3.E9_4.Enabled:=False;
If S16.Form3.E9_5.Text='H' then S16.Form3.E9_5.Text:=''
  else S16.Form3.E9_5.Enabled:=False;
If S16.Form3.E9_6.Text='H' then S16.Form3.E9_6.Text:=''
  else S16.Form3.E9_6.Enabled:=False;
If S16.Form3.E9_7.Text='H' then S16.Form3.E9_7.Text:=''
  else S16.Form3.E9_7.Enabled:=False;
If S16.Form3.E9_8.Text='H' then S16.Form3.E9_8.Text:=''
  else S16.Form3.E9_8.Enabled:=False;
If S16.Form3.E9_9.Text='H' then S16.Form3.E9_9.Text:=''
  else S16.Form3.E9_9.Enabled:=False;
If S16.Form3.E9_10.Text='H' then S16.Form3.E9_10.Text:=''
  else S16.Form3.E9_10.Enabled:=False;
If S16.Form3.E9_11.Text='H' then S16.Form3.E9_11.Text:=''
  else S16.Form3.E9_11.Enabled:=False;
If S16.Form3.E9_12.Text='H' then S16.Form3.E9_12.Text:=''
  else S16.Form3.E9_12.Enabled:=False;
If S16.Form3.E9_13.Text='H' then S16.Form3.E9_13.Text:=''
  else S16.Form3.E9_13.Enabled:=False;
If S16.Form3.E9_14.Text='H' then S16.Form3.E9_14.Text:=''
  else S16.Form3.E9_14.Enabled:=False;
If S16.Form3.E9_15.Text='H' then S16.Form3.E9_15.Text:=''
  else S16.Form3.E9_15.Enabled:=False;
If S16.Form3.E9_16.Text='H' then S16.Form3.E9_16.Text:=''
  else S16.Form3.E9_16.Enabled:=False;
If S16.Form3.E10_1.Text='H' then S16.Form3.E10_1.Text:=''
  else S16.Form3.E10_1.Enabled:=False;
If S16.Form3.E10_2.Text='H' then S16.Form3.E10_2.Text:=''
  else S16.Form3.E10_2.Enabled:=False;
If S16.Form3.E10_3.Text='H' then S16.Form3.E10_3.Text:=''
  else S16.Form3.E10_3.Enabled:=False;
If S16.Form3.E10_4.Text='H' then S16.Form3.E10_4.Text:=''
  else S16.Form3.E10_4.Enabled:=False;
If S16.Form3.E10_5.Text='H' then S16.Form3.E10_5.Text:=''
  else S16.Form3.E10_5.Enabled:=False;
If S16.Form3.E10_6.Text='H' then S16.Form3.E10_6.Text:=''
  else S16.Form3.E10_6.Enabled:=False;
If S16.Form3.E10_7.Text='H' then S16.Form3.E10_7.Text:=''
  else S16.Form3.E10_7.Enabled:=False;
If S16.Form3.E10_8.Text='H' then S16.Form3.E10_8.Text:=''
  else S16.Form3.E10_8.Enabled:=False;
If S16.Form3.E10_9.Text='H' then S16.Form3.E10_9.Text:=''
  else S16.Form3.E10_9.Enabled:=False;
If S16.Form3.E10_10.Text='H' then S16.Form3.E10_10.Text:=''
  else S16.Form3.E10_10.Enabled:=False;
If S16.Form3.E10_11.Text='H' then S16.Form3.E10_11.Text:=''
  else S16.Form3.E10_11.Enabled:=False;
If S16.Form3.E10_12.Text='H' then S16.Form3.E10_12.Text:=''
  else S16.Form3.E10_12.Enabled:=False;
If S16.Form3.E10_13.Text='H' then S16.Form3.E10_13.Text:=''
  else S16.Form3.E10_13.Enabled:=False;
If S16.Form3.E10_14.Text='H' then S16.Form3.E10_14.Text:=''
  else S16.Form3.E10_14.Enabled:=False;
If S16.Form3.E10_15.Text='H' then S16.Form3.E10_15.Text:=''
  else S16.Form3.E10_15.Enabled:=False;
If S16.Form3.E10_16.Text='H' then S16.Form3.E10_16.Text:=''
  else S16.Form3.E10_16.Enabled:=False;
If S16.Form3.E11_1.Text='H' then S16.Form3.E11_1.Text:=''
  else S16.Form3.E11_1.Enabled:=False;
If S16.Form3.E11_2.Text='H' then S16.Form3.E11_2.Text:=''
  else S16.Form3.E11_2.Enabled:=False;
If S16.Form3.E11_3.Text='H' then S16.Form3.E11_3.Text:=''
  else S16.Form3.E11_3.Enabled:=False;
If S16.Form3.E11_4.Text='H' then S16.Form3.E11_4.Text:=''
  else S16.Form3.E11_4.Enabled:=False;
If S16.Form3.E11_5.Text='H' then S16.Form3.E11_5.Text:=''
  else S16.Form3.E11_5.Enabled:=False;
If S16.Form3.E11_6.Text='H' then S16.Form3.E11_6.Text:=''
  else S16.Form3.E11_6.Enabled:=False;
If S16.Form3.E11_7.Text='H' then S16.Form3.E11_7.Text:=''
  else S16.Form3.E11_7.Enabled:=False;
If S16.Form3.E11_8.Text='H' then S16.Form3.E11_8.Text:=''
  else S16.Form3.E11_8.Enabled:=False;
If S16.Form3.E11_9.Text='H' then S16.Form3.E11_9.Text:=''
  else S16.Form3.E11_9.Enabled:=False;
If S16.Form3.E11_10.Text='H' then S16.Form3.E11_10.Text:=''
  else S16.Form3.E11_10.Enabled:=False;
If S16.Form3.E11_11.Text='H' then S16.Form3.E11_11.Text:=''
  else S16.Form3.E11_11.Enabled:=False;
If S16.Form3.E11_12.Text='H' then S16.Form3.E11_12.Text:=''
  else S16.Form3.E11_12.Enabled:=False;
If S16.Form3.E11_13.Text='H' then S16.Form3.E11_13.Text:=''
  else S16.Form3.E11_13.Enabled:=False;
If S16.Form3.E11_14.Text='H' then S16.Form3.E11_14.Text:=''
  else S16.Form3.E11_14.Enabled:=False;
If S16.Form3.E11_15.Text='H' then S16.Form3.E11_15.Text:=''
  else S16.Form3.E11_15.Enabled:=False;
If S16.Form3.E11_16.Text='H' then S16.Form3.E11_16.Text:=''
  else S16.Form3.E11_16.Enabled:=False;
If S16.Form3.E12_1.Text='H' then S16.Form3.E12_1.Text:=''
  else S16.Form3.E12_1.Enabled:=False;
If S16.Form3.E12_2.Text='H' then S16.Form3.E12_2.Text:=''
  else S16.Form3.E12_2.Enabled:=False;
If S16.Form3.E12_3.Text='H' then S16.Form3.E12_3.Text:=''
  else S16.Form3.E12_3.Enabled:=False;
If S16.Form3.E12_4.Text='H' then S16.Form3.E12_4.Text:=''
  else S16.Form3.E12_4.Enabled:=False;
If S16.Form3.E12_5.Text='H' then S16.Form3.E12_5.Text:=''
  else S16.Form3.E12_5.Enabled:=False;
If S16.Form3.E12_6.Text='H' then S16.Form3.E12_6.Text:=''
  else S16.Form3.E12_6.Enabled:=False;
If S16.Form3.E12_7.Text='H' then S16.Form3.E12_7.Text:=''
  else S16.Form3.E12_7.Enabled:=False;
If S16.Form3.E12_8.Text='H' then S16.Form3.E12_8.Text:=''
  else S16.Form3.E12_8.Enabled:=False;
If S16.Form3.E12_9.Text='H' then S16.Form3.E12_9.Text:=''
  else S16.Form3.E12_9.Enabled:=False;
If S16.Form3.E12_10.Text='H' then S16.Form3.E12_10.Text:=''
  else S16.Form3.E12_10.Enabled:=False;
If S16.Form3.E12_11.Text='H' then S16.Form3.E12_11.Text:=''
  else S16.Form3.E12_11.Enabled:=False;
If S16.Form3.E12_12.Text='H' then S16.Form3.E12_12.Text:=''
  else S16.Form3.E12_12.Enabled:=False;
If S16.Form3.E12_13.Text='H' then S16.Form3.E12_13.Text:=''
  else S16.Form3.E12_13.Enabled:=False;
If S16.Form3.E12_14.Text='H' then S16.Form3.E12_14.Text:=''
  else S16.Form3.E12_14.Enabled:=False;
If S16.Form3.E12_15.Text='H' then S16.Form3.E12_15.Text:=''
  else S16.Form3.E12_15.Enabled:=False;
If S16.Form3.E12_16.Text='H' then S16.Form3.E12_16.Text:=''
  else S16.Form3.E12_16.Enabled:=False;
If S16.Form3.E13_1.Text='H' then S16.Form3.E13_1.Text:=''
  else S16.Form3.E13_1.Enabled:=False;
If S16.Form3.E13_2.Text='H' then S16.Form3.E13_2.Text:=''
  else S16.Form3.E13_2.Enabled:=False;
If S16.Form3.E13_3.Text='H' then S16.Form3.E13_3.Text:=''
  else S16.Form3.E13_3.Enabled:=False;
If S16.Form3.E13_4.Text='H' then S16.Form3.E13_4.Text:=''
  else S16.Form3.E13_4.Enabled:=False;
If S16.Form3.E13_5.Text='H' then S16.Form3.E13_5.Text:=''
  else S16.Form3.E13_5.Enabled:=False;
If S16.Form3.E13_6.Text='H' then S16.Form3.E13_6.Text:=''
  else S16.Form3.E13_6.Enabled:=False;
If S16.Form3.E13_7.Text='H' then S16.Form3.E13_7.Text:=''
  else S16.Form3.E13_7.Enabled:=False;
If S16.Form3.E13_8.Text='H' then S16.Form3.E13_8.Text:=''
  else S16.Form3.E13_8.Enabled:=False;
If S16.Form3.E13_9.Text='H' then S16.Form3.E13_9.Text:=''
  else S16.Form3.E13_9.Enabled:=False;
If S16.Form3.E13_10.Text='H' then S16.Form3.E13_10.Text:=''
  else S16.Form3.E13_10.Enabled:=False;
If S16.Form3.E13_11.Text='H' then S16.Form3.E13_11.Text:=''
  else S16.Form3.E13_11.Enabled:=False;
If S16.Form3.E13_12.Text='H' then S16.Form3.E13_12.Text:=''
  else S16.Form3.E13_12.Enabled:=False;
If S16.Form3.E13_13.Text='H' then S16.Form3.E13_13.Text:=''
  else S16.Form3.E13_13.Enabled:=False;
If S16.Form3.E13_14.Text='H' then S16.Form3.E13_14.Text:=''
  else S16.Form3.E13_14.Enabled:=False;
If S16.Form3.E13_15.Text='H' then S16.Form3.E13_15.Text:=''
  else S16.Form3.E13_15.Enabled:=False;
If S16.Form3.E13_16.Text='H' then S16.Form3.E13_16.Text:=''
  else S16.Form3.E13_16.Enabled:=False;
If S16.Form3.E14_1.Text='H' then S16.Form3.E14_1.Text:=''
  else S16.Form3.E14_1.Enabled:=False;
If S16.Form3.E14_2.Text='H' then S16.Form3.E14_2.Text:=''
  else S16.Form3.E14_2.Enabled:=False;
If S16.Form3.E14_3.Text='H' then S16.Form3.E14_3.Text:=''
  else S16.Form3.E14_3.Enabled:=False;
If S16.Form3.E14_4.Text='H' then S16.Form3.E14_4.Text:=''
  else S16.Form3.E14_4.Enabled:=False;
If S16.Form3.E14_5.Text='H' then S16.Form3.E14_5.Text:=''
  else S16.Form3.E14_5.Enabled:=False;
If S16.Form3.E14_6.Text='H' then S16.Form3.E14_6.Text:=''
  else S16.Form3.E14_6.Enabled:=False;
If S16.Form3.E14_7.Text='H' then S16.Form3.E14_7.Text:=''
  else S16.Form3.E14_7.Enabled:=False;
If S16.Form3.E14_8.Text='H' then S16.Form3.E14_8.Text:=''
  else S16.Form3.E14_8.Enabled:=False;
If S16.Form3.E14_9.Text='H' then S16.Form3.E14_9.Text:=''
  else S16.Form3.E14_9.Enabled:=False;
If S16.Form3.E14_10.Text='H' then S16.Form3.E14_10.Text:=''
  else S16.Form3.E14_10.Enabled:=False;
If S16.Form3.E14_11.Text='H' then S16.Form3.E14_11.Text:=''
  else S16.Form3.E14_11.Enabled:=False;
If S16.Form3.E14_12.Text='H' then S16.Form3.E14_12.Text:=''
  else S16.Form3.E14_12.Enabled:=False;
If S16.Form3.E14_13.Text='H' then S16.Form3.E14_13.Text:=''
  else S16.Form3.E14_13.Enabled:=False;
If S16.Form3.E14_14.Text='H' then S16.Form3.E14_14.Text:=''
  else S16.Form3.E14_14.Enabled:=False;
If S16.Form3.E14_15.Text='H' then S16.Form3.E14_15.Text:=''
  else S16.Form3.E14_15.Enabled:=False;
If S16.Form3.E14_16.Text='H' then S16.Form3.E14_16.Text:=''
  else S16.Form3.E14_16.Enabled:=False;
If S16.Form3.E15_1.Text='H' then S16.Form3.E15_1.Text:=''
  else S16.Form3.E15_1.Enabled:=False;
If S16.Form3.E15_2.Text='H' then S16.Form3.E15_2.Text:=''
  else S16.Form3.E15_2.Enabled:=False;
If S16.Form3.E15_3.Text='H' then S16.Form3.E15_3.Text:=''
  else S16.Form3.E15_3.Enabled:=False;
If S16.Form3.E15_4.Text='H' then S16.Form3.E15_4.Text:=''
  else S16.Form3.E15_4.Enabled:=False;
If S16.Form3.E15_5.Text='H' then S16.Form3.E15_5.Text:=''
  else S16.Form3.E15_5.Enabled:=False;
If S16.Form3.E15_6.Text='H' then S16.Form3.E15_6.Text:=''
  else S16.Form3.E15_6.Enabled:=False;
If S16.Form3.E15_7.Text='H' then S16.Form3.E15_7.Text:=''
  else S16.Form3.E15_7.Enabled:=False;
If S16.Form3.E15_8.Text='H' then S16.Form3.E15_8.Text:=''
  else S16.Form3.E15_8.Enabled:=False;
If S16.Form3.E15_9.Text='H' then S16.Form3.E15_9.Text:=''
  else S16.Form3.E15_9.Enabled:=False;
If S16.Form3.E15_10.Text='H' then S16.Form3.E15_10.Text:=''
  else S16.Form3.E15_10.Enabled:=False;
If S16.Form3.E15_11.Text='H' then S16.Form3.E15_11.Text:=''
  else S16.Form3.E15_11.Enabled:=False;
If S16.Form3.E15_12.Text='H' then S16.Form3.E15_12.Text:=''
  else S16.Form3.E15_12.Enabled:=False;
If S16.Form3.E15_13.Text='H' then S16.Form3.E15_13.Text:=''
  else S16.Form3.E15_13.Enabled:=False;
If S16.Form3.E15_14.Text='H' then S16.Form3.E15_14.Text:=''
  else S16.Form3.E15_14.Enabled:=False;
If S16.Form3.E15_15.Text='H' then S16.Form3.E15_15.Text:=''
  else S16.Form3.E15_15.Enabled:=False;
If S16.Form3.E15_16.Text='H' then S16.Form3.E15_16.Text:=''
  else S16.Form3.E15_16.Enabled:=False;
If S16.Form3.E16_1.Text='H' then S16.Form3.E16_1.Text:=''
  else S16.Form3.E16_1.Enabled:=False;
If S16.Form3.E16_2.Text='H' then S16.Form3.E16_2.Text:=''
  else S16.Form3.E16_2.Enabled:=False;
If S16.Form3.E16_3.Text='H' then S16.Form3.E16_3.Text:=''
  else S16.Form3.E16_3.Enabled:=False;
If S16.Form3.E16_4.Text='H' then S16.Form3.E16_4.Text:=''
  else S16.Form3.E16_4.Enabled:=False;
If S16.Form3.E16_5.Text='H' then S16.Form3.E16_5.Text:=''
  else S16.Form3.E16_5.Enabled:=False;
If S16.Form3.E16_6.Text='H' then S16.Form3.E16_6.Text:=''
  else S16.Form3.E16_6.Enabled:=False;
If S16.Form3.E16_7.Text='H' then S16.Form3.E16_7.Text:=''
  else S16.Form3.E16_7.Enabled:=False;
If S16.Form3.E16_8.Text='H' then S16.Form3.E16_8.Text:=''
  else S16.Form3.E16_8.Enabled:=False;
If S16.Form3.E16_9.Text='H' then S16.Form3.E16_9.Text:=''
  else S16.Form3.E16_9.Enabled:=False;
If S16.Form3.E16_10.Text='H' then S16.Form3.E16_10.Text:=''
  else S16.Form3.E16_10.Enabled:=False;
If S16.Form3.E16_11.Text='H' then S16.Form3.E16_11.Text:=''
  else S16.Form3.E16_11.Enabled:=False;
If S16.Form3.E16_12.Text='H' then S16.Form3.E16_12.Text:=''
  else S16.Form3.E16_12.Enabled:=False;
If S16.Form3.E16_13.Text='H' then S16.Form3.E16_13.Text:=''
  else S16.Form3.E16_13.Enabled:=False;
If S16.Form3.E16_14.Text='H' then S16.Form3.E16_14.Text:=''
  else S16.Form3.E16_14.Enabled:=False;
If S16.Form3.E16_15.Text='H' then S16.Form3.E16_15.Text:=''
  else S16.Form3.E16_15.Enabled:=False;
If S16.Form3.E16_16.Text='H' then S16.Form3.E16_16.Text:=''
  else S16.Form3.E16_16.Enabled:=False;
End;

Procedure ShowMap;
Begin
S16.Form3.E1_1.Text:=Map[1,1];
S16.Form3.E1_2.Text:=Map[1,2];
S16.Form3.E1_3.Text:=Map[1,3];
S16.Form3.E1_4.Text:=Map[1,4];
S16.Form3.E1_5.Text:=Map[1,5];
S16.Form3.E1_6.Text:=Map[1,6];
S16.Form3.E1_7.Text:=Map[1,7];
S16.Form3.E1_8.Text:=Map[1,8];
S16.Form3.E1_9.Text:=Map[1,9];
S16.Form3.E1_10.Text:=Map[1,10];
S16.Form3.E1_11.Text:=Map[1,11];
S16.Form3.E1_12.Text:=Map[1,12];
S16.Form3.E1_13.Text:=Map[1,13];
S16.Form3.E1_14.Text:=Map[1,14];
S16.Form3.E1_15.Text:=Map[1,15];
S16.Form3.E1_16.Text:=Map[1,16];
S16.Form3.E2_1.Text:=Map[2,1];
S16.Form3.E2_2.Text:=Map[2,2];
S16.Form3.E2_3.Text:=Map[2,3];
S16.Form3.E2_4.Text:=Map[2,4];
S16.Form3.E2_5.Text:=Map[2,5];
S16.Form3.E2_6.Text:=Map[2,6];
S16.Form3.E2_7.Text:=Map[2,7];
S16.Form3.E2_8.Text:=Map[2,8];
S16.Form3.E2_9.Text:=Map[2,9];
S16.Form3.E2_10.Text:=Map[2,10];
S16.Form3.E2_11.Text:=Map[2,11];
S16.Form3.E2_12.Text:=Map[2,12];
S16.Form3.E2_13.Text:=Map[2,13];
S16.Form3.E2_14.Text:=Map[2,14];
S16.Form3.E2_15.Text:=Map[2,15];
S16.Form3.E2_16.Text:=Map[2,16];
S16.Form3.E3_1.Text:=Map[3,1];
S16.Form3.E3_2.Text:=Map[3,2];
S16.Form3.E3_3.Text:=Map[3,3];
S16.Form3.E3_4.Text:=Map[3,4];
S16.Form3.E3_5.Text:=Map[3,5];
S16.Form3.E3_6.Text:=Map[3,6];
S16.Form3.E3_7.Text:=Map[3,7];
S16.Form3.E3_8.Text:=Map[3,8];
S16.Form3.E3_9.Text:=Map[3,9];
S16.Form3.E3_10.Text:=Map[3,10];
S16.Form3.E3_11.Text:=Map[3,11];
S16.Form3.E3_12.Text:=Map[3,12];
S16.Form3.E3_13.Text:=Map[3,13];
S16.Form3.E3_14.Text:=Map[3,14];
S16.Form3.E3_15.Text:=Map[3,15];
S16.Form3.E3_16.Text:=Map[3,16];
S16.Form3.E4_1.Text:=Map[4,1];
S16.Form3.E4_2.Text:=Map[4,2];
S16.Form3.E4_3.Text:=Map[4,3];
S16.Form3.E4_4.Text:=Map[4,4];
S16.Form3.E4_5.Text:=Map[4,5];
S16.Form3.E4_6.Text:=Map[4,6];
S16.Form3.E4_7.Text:=Map[4,7];
S16.Form3.E4_8.Text:=Map[4,8];
S16.Form3.E4_9.Text:=Map[4,9];
S16.Form3.E4_10.Text:=Map[4,10];
S16.Form3.E4_11.Text:=Map[4,11];
S16.Form3.E4_12.Text:=Map[4,12];
S16.Form3.E4_13.Text:=Map[4,13];
S16.Form3.E4_14.Text:=Map[4,14];
S16.Form3.E4_15.Text:=Map[4,15];
S16.Form3.E4_16.Text:=Map[4,16];
S16.Form3.E5_1.Text:=Map[5,1];
S16.Form3.E5_2.Text:=Map[5,2];
S16.Form3.E5_3.Text:=Map[5,3];
S16.Form3.E5_4.Text:=Map[5,4];
S16.Form3.E5_5.Text:=Map[5,5];
S16.Form3.E5_6.Text:=Map[5,6];
S16.Form3.E5_7.Text:=Map[5,7];
S16.Form3.E5_8.Text:=Map[5,8];
S16.Form3.E5_9.Text:=Map[5,9];
S16.Form3.E5_10.Text:=Map[5,10];
S16.Form3.E5_11.Text:=Map[5,11];
S16.Form3.E5_12.Text:=Map[5,12];
S16.Form3.E5_13.Text:=Map[5,13];
S16.Form3.E5_14.Text:=Map[5,14];
S16.Form3.E5_15.Text:=Map[5,15];
S16.Form3.E5_16.Text:=Map[5,16];
S16.Form3.E6_1.Text:=Map[6,1];
S16.Form3.E6_2.Text:=Map[6,2];
S16.Form3.E6_3.Text:=Map[6,3];
S16.Form3.E6_4.Text:=Map[6,4];
S16.Form3.E6_5.Text:=Map[6,5];
S16.Form3.E6_6.Text:=Map[6,6];
S16.Form3.E6_7.Text:=Map[6,7];
S16.Form3.E6_8.Text:=Map[6,8];
S16.Form3.E6_9.Text:=Map[6,9];
S16.Form3.E6_10.Text:=Map[6,10];
S16.Form3.E6_11.Text:=Map[6,11];
S16.Form3.E6_12.Text:=Map[6,12];
S16.Form3.E6_13.Text:=Map[6,13];
S16.Form3.E6_14.Text:=Map[6,14];
S16.Form3.E6_15.Text:=Map[6,15];
S16.Form3.E6_16.Text:=Map[6,16];
S16.Form3.E7_1.Text:=Map[7,1];
S16.Form3.E7_2.Text:=Map[7,2];
S16.Form3.E7_3.Text:=Map[7,3];
S16.Form3.E7_4.Text:=Map[7,4];
S16.Form3.E7_5.Text:=Map[7,5];
S16.Form3.E7_6.Text:=Map[7,6];
S16.Form3.E7_7.Text:=Map[7,7];
S16.Form3.E7_8.Text:=Map[7,8];
S16.Form3.E7_9.Text:=Map[7,9];
S16.Form3.E7_10.Text:=Map[7,10];
S16.Form3.E7_11.Text:=Map[7,11];
S16.Form3.E7_12.Text:=Map[7,12];
S16.Form3.E7_13.Text:=Map[7,13];
S16.Form3.E7_14.Text:=Map[7,14];
S16.Form3.E7_15.Text:=Map[7,15];
S16.Form3.E7_16.Text:=Map[7,16];
S16.Form3.E8_1.Text:=Map[8,1];
S16.Form3.E8_2.Text:=Map[8,2];
S16.Form3.E8_3.Text:=Map[8,3];
S16.Form3.E8_4.Text:=Map[8,4];
S16.Form3.E8_5.Text:=Map[8,5];
S16.Form3.E8_6.Text:=Map[8,6];
S16.Form3.E8_7.Text:=Map[8,7];
S16.Form3.E8_8.Text:=Map[8,8];
S16.Form3.E8_9.Text:=Map[8,9];
S16.Form3.E8_10.Text:=Map[8,10];
S16.Form3.E8_11.Text:=Map[8,11];
S16.Form3.E8_12.Text:=Map[8,12];
S16.Form3.E8_13.Text:=Map[8,13];
S16.Form3.E8_14.Text:=Map[8,14];
S16.Form3.E8_15.Text:=Map[8,15];
S16.Form3.E8_16.Text:=Map[8,16];
S16.Form3.E9_1.Text:=Map[9,1];
S16.Form3.E9_2.Text:=Map[9,2];
S16.Form3.E9_3.Text:=Map[9,3];
S16.Form3.E9_4.Text:=Map[9,4];
S16.Form3.E9_5.Text:=Map[9,5];
S16.Form3.E9_6.Text:=Map[9,6];
S16.Form3.E9_7.Text:=Map[9,7];
S16.Form3.E9_8.Text:=Map[9,8];
S16.Form3.E9_9.Text:=Map[9,9];
S16.Form3.E9_10.Text:=Map[9,10];
S16.Form3.E9_11.Text:=Map[9,11];
S16.Form3.E9_12.Text:=Map[9,12];
S16.Form3.E9_13.Text:=Map[9,13];
S16.Form3.E9_14.Text:=Map[9,14];
S16.Form3.E9_15.Text:=Map[9,15];
S16.Form3.E9_16.Text:=Map[9,16];
S16.Form3.E10_1.Text:=Map[10,1];
S16.Form3.E10_2.Text:=Map[10,2];
S16.Form3.E10_3.Text:=Map[10,3];
S16.Form3.E10_4.Text:=Map[10,4];
S16.Form3.E10_5.Text:=Map[10,5];
S16.Form3.E10_6.Text:=Map[10,6];
S16.Form3.E10_7.Text:=Map[10,7];
S16.Form3.E10_8.Text:=Map[10,8];
S16.Form3.E10_9.Text:=Map[10,9];
S16.Form3.E10_10.Text:=Map[10,10];
S16.Form3.E10_11.Text:=Map[10,11];
S16.Form3.E10_12.Text:=Map[10,12];
S16.Form3.E10_13.Text:=Map[10,13];
S16.Form3.E10_14.Text:=Map[10,14];
S16.Form3.E10_15.Text:=Map[10,15];
S16.Form3.E10_16.Text:=Map[10,16];
S16.Form3.E11_1.Text:=Map[11,1];
S16.Form3.E11_2.Text:=Map[11,2];
S16.Form3.E11_3.Text:=Map[11,3];
S16.Form3.E11_4.Text:=Map[11,4];
S16.Form3.E11_5.Text:=Map[11,5];
S16.Form3.E11_6.Text:=Map[11,6];
S16.Form3.E11_7.Text:=Map[11,7];
S16.Form3.E11_8.Text:=Map[11,8];
S16.Form3.E11_9.Text:=Map[11,9];
S16.Form3.E11_10.Text:=Map[11,10];
S16.Form3.E11_11.Text:=Map[11,11];
S16.Form3.E11_12.Text:=Map[11,12];
S16.Form3.E11_13.Text:=Map[11,13];
S16.Form3.E11_14.Text:=Map[11,14];
S16.Form3.E11_15.Text:=Map[11,15];
S16.Form3.E11_16.Text:=Map[11,16];
S16.Form3.E12_1.Text:=Map[12,1];
S16.Form3.E12_2.Text:=Map[12,2];
S16.Form3.E12_3.Text:=Map[12,3];
S16.Form3.E12_4.Text:=Map[12,4];
S16.Form3.E12_5.Text:=Map[12,5];
S16.Form3.E12_6.Text:=Map[12,6];
S16.Form3.E12_7.Text:=Map[12,7];
S16.Form3.E12_8.Text:=Map[12,8];
S16.Form3.E12_9.Text:=Map[12,9];
S16.Form3.E12_10.Text:=Map[12,10];
S16.Form3.E12_11.Text:=Map[12,11];
S16.Form3.E12_12.Text:=Map[12,12];
S16.Form3.E12_13.Text:=Map[12,13];
S16.Form3.E12_14.Text:=Map[12,14];
S16.Form3.E12_15.Text:=Map[12,15];
S16.Form3.E12_16.Text:=Map[12,16];
S16.Form3.E13_1.Text:=Map[13,1];
S16.Form3.E13_2.Text:=Map[13,2];
S16.Form3.E13_3.Text:=Map[13,3];
S16.Form3.E13_4.Text:=Map[13,4];
S16.Form3.E13_5.Text:=Map[13,5];
S16.Form3.E13_6.Text:=Map[13,6];
S16.Form3.E13_7.Text:=Map[13,7];
S16.Form3.E13_8.Text:=Map[13,8];
S16.Form3.E13_9.Text:=Map[13,9];
S16.Form3.E13_10.Text:=Map[13,10];
S16.Form3.E13_11.Text:=Map[13,11];
S16.Form3.E13_12.Text:=Map[13,12];
S16.Form3.E13_13.Text:=Map[13,13];
S16.Form3.E13_14.Text:=Map[13,14];
S16.Form3.E13_15.Text:=Map[13,15];
S16.Form3.E13_16.Text:=Map[13,16];
S16.Form3.E14_1.Text:=Map[14,1];
S16.Form3.E14_2.Text:=Map[14,2];
S16.Form3.E14_3.Text:=Map[14,3];
S16.Form3.E14_4.Text:=Map[14,4];
S16.Form3.E14_5.Text:=Map[14,5];
S16.Form3.E14_6.Text:=Map[14,6];
S16.Form3.E14_7.Text:=Map[14,7];
S16.Form3.E14_8.Text:=Map[14,8];
S16.Form3.E14_9.Text:=Map[14,9];
S16.Form3.E14_10.Text:=Map[14,10];
S16.Form3.E14_11.Text:=Map[14,11];
S16.Form3.E14_12.Text:=Map[14,12];
S16.Form3.E14_13.Text:=Map[14,13];
S16.Form3.E14_14.Text:=Map[14,14];
S16.Form3.E14_15.Text:=Map[14,15];
S16.Form3.E14_16.Text:=Map[14,16];
S16.Form3.E15_1.Text:=Map[15,1];
S16.Form3.E15_2.Text:=Map[15,2];
S16.Form3.E15_3.Text:=Map[15,3];
S16.Form3.E15_4.Text:=Map[15,4];
S16.Form3.E15_5.Text:=Map[15,5];
S16.Form3.E15_6.Text:=Map[15,6];
S16.Form3.E15_7.Text:=Map[15,7];
S16.Form3.E15_8.Text:=Map[15,8];
S16.Form3.E15_9.Text:=Map[15,9];
S16.Form3.E15_10.Text:=Map[15,10];
S16.Form3.E15_11.Text:=Map[15,11];
S16.Form3.E15_12.Text:=Map[15,12];
S16.Form3.E15_13.Text:=Map[15,13];
S16.Form3.E15_14.Text:=Map[15,14];
S16.Form3.E15_15.Text:=Map[15,15];
S16.Form3.E15_16.Text:=Map[15,16];
S16.Form3.E16_1.Text:=Map[16,1];
S16.Form3.E16_2.Text:=Map[16,2];
S16.Form3.E16_3.Text:=Map[16,3];
S16.Form3.E16_4.Text:=Map[16,4];
S16.Form3.E16_5.Text:=Map[16,5];
S16.Form3.E16_6.Text:=Map[16,6];
S16.Form3.E16_7.Text:=Map[16,7];
S16.Form3.E16_8.Text:=Map[16,8];
S16.Form3.E16_9.Text:=Map[16,9];
S16.Form3.E16_10.Text:=Map[16,10];
S16.Form3.E16_11.Text:=Map[16,11];
S16.Form3.E16_12.Text:=Map[16,12];
S16.Form3.E16_13.Text:=Map[16,13];
S16.Form3.E16_14.Text:=Map[16,14];
S16.Form3.E16_15.Text:=Map[16,15];
S16.Form3.E16_16.Text:=Map[16,16];
End;

procedure TForm3.Button1Click(Sender: TObject);
begin
Timer1.Enabled:=False;
r:=MessageDLG('Начало новой игры удалит текущую игру. Вы уверены, что хотите начать новую?',
  mtWarning,[mbYes,mbNo],0);
if r=mrYes then
Begin
  Clearing;
  Example;
  Mapping;
  CreateMap;
  ShowMap;
  ClearMap;
  TimeGame:=0;
End;
Timer1.Enabled:=True;
end;

procedure TForm3.Button5Click(Sender: TObject);
Var
  Err:boolean;
  i,j,k,x,y,z,c:byte;
  M:array[1..16] of string[1];
  F:TextFile;
  Rec:integer;
  pos:longint;
begin
Timer1.Enabled:=false;
MapToData;
Err:=false;

for i:=1 to 16 do
  for j:=1 to 16 do
  if DataToSave[i,j]='' then err:=true;

for i:=1 to 16 do
  for j:=1 to 15 do
    for k:=j+1 to 16 do
    if DataToSave[i,j]=DataToSave[i,k] then err:=true;

for i:=1 to 16 do
  for j:=1 to 15 do
    for k:=j+1 to 16 do
    if DataToSave[j,i]=DataToSave[k,i] then err:=true;

for x:=0 to 3 do
  for y:=0 to 3 do
  begin
  k:=0;
  for i:=x*4+1 to (x+1)*4 do
    for j:=y*4+1 to (y+1)*4 do
      begin
      k:=k+1;
      M[k]:=DataToSave[i,j];
      end;

  for z:=1 to 15 do
    for c:=z+1 to 16 do
      if m[z]=m[c] then err:=true;
  end;

if err=true then
  begin
  showmessage('Есть ошибки');
  Timer1.Enabled:=true;
  End
Else
  Begin
  ShowMessage('Решено верно');
  AssignFile(F,ExtractFilePath(Application.exename )+'/Rec_G.srf');
  Reset(F);
  For i:=1 to 5 do Readln(F,Rec);
  for i:=0 to ComboBox1.ItemIndex do
      Readln(F,Rec);
  CloseFile(F);
  if TimeGame<Rec then
    Begin
    ShowMessage('Вы решили быстрее всех');
    ListBox1.Items.LoadFromFile(ExtractFilePath(Application.exename )+'/Rec_G.srf');
    ListBox1.Items.Strings[5+ComboBox1.ItemIndex]:=inttostr(TimeGame);
    ListBox1.Items.SaveToFile(ExtractFilePath(Application.exename )+'/Rec_G.srf');
    End;

  Begin
  AssignFile(F,ExtractFilePath(Application.exename )+'/Rec_B.srf');
  Reset(F);
  for i:=1 to 5 do  Readln(F,Rec);
  for i:=0 to ComboBox1.ItemIndex do
      Readln(F,Rec);
  CloseFile(F);
  if TimeGame>Rec then
    Begin
    ShowMessage('Вы решили Медленнее всех');
    ListBox1.Items.LoadFromFile(ExtractFilePath(Application.exename )+'/Rec_B.srf');
    ListBox1.Items.Strings[5+ComboBox1.ItemIndex]:=inttostr(TimeGame);
    ListBox1.Items.SaveToFile(ExtractFilePath(Application.exename )+'/Rec_B.srf');
    End;
    End;
  End;
end;

procedure TForm3.Timer1Timer(Sender: TObject);
begin
inc(TimeGame);
Label1.Caption:=inttostr(TimeGame);
end;

procedure TForm3.FormCreate(Sender: TObject);
begin
ClearMap;
Clearing;
end;

procedure TForm3.ComboBox1Change(Sender: TObject);
begin
Timer1.Enabled:=False;
r:=MessageDLG('Начало новой игры удалит текущую игру. Вы уверены, что хотите начать новую?',
  mtWarning,[mbYes,mbNo],0);
if r=mrYes then
Begin
  Clearing;
  Example;
  Mapping;
  CreateMap;
  ShowMap;
  ClearMap;
  TimeGame:=0;
  Level:=Combobox1.ItemIndex;
End;
Combobox1.ItemIndex:=Level;
Timer1.Enabled:=True;
end;

procedure TForm3.Button2Click(Sender: TObject);
Var
  F:TextFile;
  i,j:byte;
  str:string[4];
  Name:String;
begin
Timer1.Enabled:=false;
if SaveDialog1.Execute then
begin
MapToData;
str:='';
Name:=SaveDialog1.FileName;
for i:=length(Name)-3 to length(Name) do
  str:=str+Name[i];
if str<>'.ssh' then AssignFile(F,SaveDialog1.FileName+'.ssh')
  else AssignFile(F,SaveDialog1.FileName);
Rewrite(F);
for i:=1 to 16 do
  Begin
  For j:=1 to 16 do
    Begin
    if DataToSave[i,j]='' then DataToSave[i,j]:='H';
    Writeln(F,DataToSave[i,j]);
    End;
  End;
for i:=1 to 16 do
  Begin
  For j:=1 to 16 do
    Begin
    Writeln(F,Map[i,j]);
    End;
  End;
Writeln(F,comboBox1.ItemIndex);
Writeln(F,TimeGame);
CloseFile(F)
end;
Timer1.Enabled:=True;
end;

procedure TForm3.Button3Click(Sender: TObject);
Var
  F:TextFile;
  i,j,k:byte;
begin
Timer1.Enabled:=false;
if OpenDialog1.Execute then
begin
AssignFile(F,OpenDialog1.FileName);
Reset(F);
for i:=1 to 16 do
  Begin
  For j:=1 to 16 do
    Begin
    Readln(F,DataToSave[i,j]);
    if DataToSave[i,j]='H' then DataToSave[i,j]:='';
    End;
  End;
for i:=1 to 16 do
  Begin
  For j:=1 to 16 do
    Begin
    Readln(F,Map[i,j]);
    End;
  End;
Readln(F,k);
ComboBox1.ItemIndex:=k;
Readln(F,TimeGame);
CloseFile(F);

Clearing;
ShowMap;
ClearMap;
DataToMap;
end;
Timer1.Enabled:=true;
end;

procedure TForm3.FormCloseQuery(Sender: TObject; var CanClose: Boolean);
begin
Timer1.Enabled:=false;
CanClose:=false;
r:=MessageDLG('Вы уверены, что хотите выйти?',mtWarning,[mbYes,mbNo],0);
if r=mrYes then CanClose:=true
else timer1.Enabled:=true;
end;

procedure TForm3.FormClose(Sender: TObject; var Action: TCloseAction);
begin
FullClear;
end;

procedure TForm3.Button4Click(Sender: TObject);
begin
Close;
end;

procedure TForm3.E1_1KeyUp(Sender: TObject; var Key: Word;
  Shift: TShiftState);
Var ch:char;
begin
if TEdit(Sender).Text='' then TEdit(Sender).Text:=' ';
ch:=TEdit(Sender).Text[1];
case ch of
  'a': TEdit(Sender).Text:= 'A';
  'b': TEdit(Sender).Text:= 'B';
  'c': TEdit(Sender).Text:= 'C';
  'd': TEdit(Sender).Text:= 'D';
  'e': TEdit(Sender).Text:= 'E';
  'f': TEdit(Sender).Text:= 'F';
  end;
if not(TEdit(Sender).Text[1] in ['0'..'9'])and
  not(TEdit(Sender).Text[1] in ['A'..'F']) then  TEdit(Sender).Text:='';
end;

end.
